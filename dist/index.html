<!DOCTYPE html><html><head lang="en"><meta charset="UTF-8">
<title>Platformer</title>
<style>
  body { overflow: hidden; margin: 0; background: black; }
  body > div { margin: 7px auto auto auto; cursor: crosshair; border: 3px dotted firebrick; }
</style>
<script type="text/javascript">!function t(e,i,n){function r(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=i[o]={exports:{}};e[o][0].call(l.exports,function(t){var i=e[o][1][t];return r(i?i:t)},l,l.exports,t,e,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t){var e=t("./core.js"),i=(window.document,t("./HashMap.js"));e._rectPool=function(){var t=[],e=0;return{get:function(i,n,r,s){t.length<=e&&t.push({});var o=t[e++];return o._x=i,o._y=n,o._w=r,o._h=s,o},copy:function(i){t.length<=e&&t.push({});var n=t[e++];return n._x=i._x,n._y=i._y,n._w=i._w,n._h=i._h,n},recycle:function(){e--}}}(),e.map=new i;var n=Math,r=(n.cos,n.sin,n.PI),s=r/180;e.extend({zeroFill:function(t,e){return e-=t.toString().length,e>0?new Array(e+(/\./.test(t)?2:1)).join("0")+t:t.toString()}}),e.c("2D",{_x:0,_y:0,_w:0,_h:0,_z:0,_rotation:0,_alpha:1,_visible:!0,_globalZ:null,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,_changed:!1,_defineGetterSetter_setter:function(){this.__defineSetter__("x",function(t){this._attr("_x",t)}),this.__defineSetter__("y",function(t){this._attr("_y",t)}),this.__defineSetter__("w",function(t){this._attr("_w",t)}),this.__defineSetter__("h",function(t){this._attr("_h",t)}),this.__defineSetter__("z",function(t){this._attr("_z",t)}),this.__defineSetter__("rotation",function(t){this._attr("_rotation",t)}),this.__defineSetter__("alpha",function(t){this._attr("_alpha",t)}),this.__defineSetter__("visible",function(t){this._attr("_visible",t)}),this.__defineGetter__("x",function(){return this._x}),this.__defineGetter__("y",function(){return this._y}),this.__defineGetter__("w",function(){return this._w}),this.__defineGetter__("h",function(){return this._h}),this.__defineGetter__("z",function(){return this._z}),this.__defineGetter__("rotation",function(){return this._rotation}),this.__defineGetter__("alpha",function(){return this._alpha}),this.__defineGetter__("visible",function(){return this._visible}),this.__defineGetter__("parent",function(){return this._parent}),this.__defineGetter__("numChildren",function(){return this._children.length})},_defineGetterSetter_defineProperty:function(){Object.defineProperty(this,"x",{set:function(t){this._attr("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this._attr("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"w",{set:function(t){this._attr("_w",t)},get:function(){return this._w},configurable:!0}),Object.defineProperty(this,"h",{set:function(t){this._attr("_h",t)},get:function(){return this._h},configurable:!0}),Object.defineProperty(this,"z",{set:function(t){this._attr("_z",t)},get:function(){return this._z},configurable:!0}),Object.defineProperty(this,"rotation",{set:function(t){this._attr("_rotation",t)},get:function(){return this._rotation},configurable:!0}),Object.defineProperty(this,"alpha",{set:function(t){this._attr("_alpha",t)},get:function(){return this._alpha},configurable:!0}),Object.defineProperty(this,"visible",{set:function(t){this._attr("_visible",t)},get:function(){return this._visible},configurable:!0})},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],e.support.setter?this._defineGetterSetter_setter():e.support.defineProperty&&this._defineGetterSetter_defineProperty(),this._entry=e.map.insert(this),this.bind("Move",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)}),this.bind("Rotate",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)}),this.bind("Remove",function(){if(this._children){for(var t=0;t<this._children.length;t++)delete this._children[t]._parent,this._children[t].destroy&&this._children[t].destroy();this._children=[]}this._parent&&this._parent.detach(this),e.map.remove(this),this.detach()})},offsetBoundary:function(t,e,i,n){return 1===arguments.length&&(e=i=n=t),this._bx1=t,this._bx2=i,this._by1=e,this._by2=n,this.trigger("BoundaryOffset"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,e=this._origin.y+this._y,i=-this._rotation*s,n=this._x-this._bx1-t,r=this._x+this._w+this._bx2-t,o=this._y-this._by1-e,a=this._y+this._h+this._by2-e,h=Math.cos(i),l=Math.sin(i);h=1e-10>h&&h>-1e-10?0:h,l=1e-10>l&&l>-1e-10?0:l;var u=n*h+o*l,c=-n*l+o*h,f=r*h+o*l,A=-r*l+o*h,d=r*h+a*l,g=-r*l+a*h,m=n*h+a*l,p=-n*l+a*h,_=Math.floor(Math.min(u,f,d,m)+t),x=Math.floor(Math.min(c,A,g,p)+e),y=Math.ceil(Math.max(u,f,d,m)+t),v=Math.ceil(Math.max(c,A,g,p)+e);if(this._mbr?(this._mbr._x=_,this._mbr._y=x,this._mbr._w=y-_,this._mbr._h=v-x):this._mbr={_x:_,_y:x,_w:y-_,_h:v-x},this._cbr){var w=this._cbr,b=w.cx,G=w.cy,B=w.r,D=t+(b+this._x-t)*h+(G+this._y-e)*l,P=e-(b+this._x-t)*l+(G+this._y-e)*h;w._x=Math.min(D-B,_),w._y=Math.min(P-B,x),w._w=Math.max(D+B,y)-w._x,w._h=Math.max(P+B,v)-w._y}},_rotate:function(t){var e=-1*(t%360),i=this._rotation-t;if(0!==i){this._rotation=t;var n=e*s,r={x:this._origin.x+this._x,y:this._origin.y+this._y};this._calculateMBR();{var o=i*s;Math.cos(n),Math.sin(n)}this.trigger("Rotate",{cos:Math.cos(o),sin:Math.sin(o),deg:i,rad:o,o:r})}},area:function(){return this._w*this._h},intersect:function(t,e,i,n){var r,s=this._mbr||this;return r="object"==typeof t?t:{x:t,y:e,w:i,h:n},s._x<r.x+r.w&&s._x+s._w>r.x&&s._y<r.y+r.h&&s._h+s._y>r.y},within:function(t,e,i,n){var r,s=this._mbr||this;return r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n},r._x<=s._x&&r._x+r._w>=s._x+s._w&&r._y<=s._y&&r._y+r._h>=s._y+s._h},contains:function(t,e,i,n){var r,s=this._mbr||this;return r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n},r._x>=s._x&&r._x+r._w<=s._x+s._w&&r._y>=s._y&&r._y+r._h<=s._y+s._h},pos:function(){return{_x:this._x,_y:this._y,_w:this._w,_h:this._h}},mbr:function(){return this._mbr?{_x:this._mbr._x,_y:this._mbr._y,_w:this._mbr._w,_h:this._mbr._h}:this.pos()},isAt:function(t,e){if(this.mapArea)return this.mapArea.containsPoint(t,e);if(this.map)return this.map.containsPoint(t,e);var i=this._mbr||this;return i._x<=t&&i._x+i._w>=t&&i._y<=e&&i._y+i._h>=e},move:function(t,e){return"n"===t.charAt(0)&&(this.y-=e),"s"===t.charAt(0)&&(this.y+=e),("e"===t||"e"===t.charAt(1))&&(this.x+=e),("w"===t||"w"===t.charAt(1))&&(this.x-=e),this},shift:function(t,e,i,n){return t&&(this.x+=t),e&&(this.y+=e),i&&(this.w+=i),n&&(this.h+=n),this},_cascade:function(t){if(t){var e,i=0,n=this._children,r=n.length;if(t.cos)for(;r>i;++i)e=n[i],"rotate"in e&&e.rotate(t);else for(var s=this._x-t._x,o=this._y-t._y,a=this._w-t._w,h=this._h-t._h;r>i;++i)e=n[i],e.shift(s,o,a,h)}},attach:function(){for(var t,e=0,i=arguments,n=arguments.length;n>e;++e)t=i[e],t._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var e;if(!t){for(e=0;e<this._children.length;e++)this._children[e]._parent=null;return this._children=[],this}for(e=0;e<this._children.length;e++)this._children[e]==t&&this._children.splice(e,1);return t._parent=null,this},origin:function(t,e){if("string"==typeof t)if("centre"===t||"center"===t||-1===t.indexOf(" "))t=this._w/2,e=this._h/2;else{var i=t.split(" ");"top"===i[0]?e=0:"bottom"===i[0]?e=this._h:("middle"===i[0]||"center"===i[1]||"centre"===i[1])&&(e=this._h/2),"center"===i[1]||"centre"===i[1]||"middle"===i[1]?t=this._w/2:"left"===i[1]?t=0:"right"===i[1]&&(t=this._w)}return this._origin.x=t,this._origin.y=e,this},flip:function(t){return t=t||"X",this["_flip"+t]||(this["_flip"+t]=!0,this.trigger("Invalidate")),this},unflip:function(t){return t=t||"X",this["_flip"+t]&&(this["_flip"+t]=!1,this.trigger("Invalidate")),this},rotate:function(t){var e,i;e=(this._x+this._origin.x-t.o.x)*t.cos+(this._y+this._origin.y-t.o.y)*t.sin+(t.o.x-this._origin.x),i=(this._y+this._origin.y-t.o.y)*t.cos-(this._x+this._origin.x-t.o.x)*t.sin+(t.o.y-this._origin.y),this._attr("_rotation",this._rotation-t.deg),this._attr("_x",e),this._attr("_y",i)},_attr:function(t,i){if(this[t]!==i){var n,r=e._rectPool.copy(this);if("_rotation"===t)this._rotate(i);else if("_z"===t)this._globalZ=parseInt(i+e.zeroFill(this[0],5),10),this.trigger("reorder");else if("_x"===t||"_y"===t)n=this._mbr,n&&(n[t]-=this[t]-i,this._cbr&&(this._cbr[t]-=this[t]-i)),this[t]=i,this.trigger("Move",r);else if("_h"===t||"_w"===t){n=this._mbr;var s=this[t];this[t]=i,n&&this._calculateMBR(),"_w"===t?this.trigger("Resize",{axis:"w",amount:i-s}):"_h"===t&&this.trigger("Resize",{axis:"h",amount:i-s}),this.trigger("Move",r)}this[t]=i,this.trigger("Invalidate"),e._rectPool.recycle(r)}}}),e.c("Gravity",{_gravityConst:.2,_gy:0,_falling:!0,_anti:null,init:function(){this.requires("2D")},gravity:function(t){return t&&(this._anti=t),isNaN(this._jumpSpeed)&&(this._jumpSpeed=0),this.bind("EnterFrame",this._enterFrame),this},gravityConst:function(t){return this._gravityConst=t,this},_enterFrame:function(){this._falling?(this._gy+=this._gravityConst,this.y+=this._gy,this.trigger("Moved",{x:this._x,y:this._y-this._gy})):this._gy=0;var t,i,n,r=!1,s=this.pos(),o=0;for(s._y++,s.x=s._x,s.y=s._y,s.w=s._w,s.h=s._h,i=e.map.search(s),n=i.length;n>o;++o)if(t=i[o],t!==this&&t.has(this._anti)&&t.intersect(s)){r=t;break}r?this._falling&&(this._gy>this._jumpSpeed||!this._up)&&this.stopFalling(r):this._falling=!0},stopFalling:function(t){t&&(this.y=t._y-this._h),this._falling=!1,this._up&&(this._up=!1),this.trigger("hit")},antigravity:function(){this.unbind("EnterFrame",this._enterFrame)}}),e.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},e.polygon.prototype={containsPoint:function(t,e){var i,n,r=this.points,s=!1;for(i=0,n=r.length-1;i<r.length;n=i++)r[i][1]>e!=r[n][1]>e&&t<(r[n][0]-r[i][0])*(e-r[i][1])/(r[n][1]-r[i][1])+r[i][0]&&(s=!s);return s},shift:function(t,e){for(var i,n=0,r=this.points.length;r>n;n++)i=this.points[n],i[0]+=t,i[1]+=e},rotate:function(t){for(var e,i,n,r=0,s=this.points.length;s>r;r++)e=this.points[r],i=t.o.x+(e[0]-t.o.x)*t.cos+(e[1]-t.o.y)*t.sin,n=t.o.y-(e[0]-t.o.x)*t.sin+(e[1]-t.o.y)*t.cos,e[0]=i,e[1]=n}},e.circle=function(t,e,i){this.x=t,this.y=e,this.radius=i,this.points=[];for(var n,r=0;8>r;r++)n=r*Math.PI/4,this.points[r]=[this.x+Math.sin(n)*i,this.y+Math.cos(n)*i]},e.circle.prototype={containsPoint:function(t,e){var i=this.radius,n=(Math.sqrt,this.x-t),r=this.y-e;return i*i>n*n+r*r},shift:function(t,e){this.x+=t,this.y+=e;for(var i,n=0,r=this.points.length;r>n;n++)i=this.points[n],i[0]+=t,i[1]+=e},rotate:function(){}},e.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},e.matrix.prototype={x:function(t){if(this.width==t.height){for(var i=[],n=0;n<this.height;n++){i[n]=[];for(var r=0;r<t.width;r++){for(var s=0,o=0;o<this.width;o++)s+=this.mtx[n][o]*t.mtx[o][r];i[n][r]=s}}return new e.matrix(i)}},e:function(t,e){return 1>t||t>this.mtx.length||1>e||e>this.mtx[0].length?null:this.mtx[t-1][e-1]}}},{"./HashMap.js":4,"./core.js":9}],2:[function(t){var e=t("./core.js"),i=window.document;e.c("DOM",{_element:null,_cssStyles:null,avoidCss3dTransforms:!1,init:function(){function t(){var t=0,e=this.__c,i="";for(t in e)i+=" "+t;i=i.substr(1),this._element.className=i}function n(t){var e=0,i=this.__c,n="";for(e in i)e!=t&&(n+=" "+e);n=n.substr(1),this._element.className=n}this._cssStyles={visibility:"",left:"",top:"",width:"",height:"",zIndex:"",opacity:"",transformOrigin:"",transform:""},this._element=i.createElement("div"),e.stage.inner.appendChild(this._element),this._element.style.position="absolute",this._element.id="ent"+this[0],this.bind("Invalidate",function(){this._changed||(this._changed=!0,e.DrawManager.addDom(this))}),this.bind("NewComponent",t).bind("RemoveComponent",n),this.bind("Remove",this.undraw),this.bind("RemoveComponent",function(t){"DOM"===t&&this.undraw()})},getDomId:function(){return this._element.id},DOM:function(t){return t&&t.nodeType&&(this.undraw(),this._element=t,this._element.style.position="absolute"),this},draw:function(){var t=this._element.style,i=this.__coord||[0,0,0,0],n={x:i[0],y:i[1],w:i[2],h:i[3]},r=e.support.prefix,s=[];if(this._cssStyles.visibility!==this._visible&&(this._cssStyles.visibility=this._visible,t.visibility=this._visible?"visible":"hidden"),e.support.css3dtransform&&!this.avoidCss3dTransforms?s.push("translate3d("+~~this._x+"px,"+~~this._y+"px,0)"):(this._cssStyles.left!==this._x&&(this._cssStyles.left=this._x,t.left=~~this._x+"px"),this._cssStyles.top!==this._y&&(this._cssStyles.top=this._y,t.top=~~this._y+"px")),this._cssStyles.width!==this._w&&(this._cssStyles.width=this._w,t.width=~~this._w+"px"),this._cssStyles.height!==this._h&&(this._cssStyles.height=this._h,t.height=~~this._h+"px"),this._cssStyles.zIndex!==this._z&&(this._cssStyles.zIndex=this._z,t.zIndex=this._z),this._cssStyles.opacity!==this._alpha&&(this._cssStyles.opacity=this._alpha,t.opacity=this._alpha,t[r+"Opacity"]=this._alpha),this._mbr){var o=this._origin.x+"px "+this._origin.y+"px";t.transformOrigin=o,t[r+"TransformOrigin"]=o,s.push(e.support.css3dtransform?"rotateZ("+this._rotation+"deg)":"rotate("+this._rotation+"deg)")}return this._flipX&&s.push("scaleX(-1)"),this._flipY&&s.push("scaleY(-1)"),this._cssStyles.transform!=s.join(" ")&&(this._cssStyles.transform=s.join(" "),t.transform=this._cssStyles.transform,t[r+"Transform"]=this._cssStyles.transform),this.trigger("Draw",{style:t,type:"DOM",co:n}),this},undraw:function(){return this._element&&e.stage.inner.removeChild(this._element),this},css:function(t,i){var n,r,s=this._element,o=s.style;if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(r=t[n],"number"==typeof r&&(r+="px"),o[e.DOM.camelize(n)]=r);else{if(!i)return e.DOM.getStyle(s,t);"number"==typeof i&&(i+="px"),o[e.DOM.camelize(t)]=i}return this.trigger("Invalidate"),this}}),e.extend({DOM:{window:{init:function(){this.width=window.innerWidth||window.document.documentElement.clientWidth||window.document.body.clientWidth,this.height=window.innerHeight||window.document.documentElement.clientHeight||window.document.body.clientHeight,e.uniqueBind("RenderScene",e.DrawManager.renderDOM),e.uniqueBind("ViewportResize",this._resize)},_resize:function(){e.stage.elem.style.width=e.viewport.width+"px",e.stage.elem.style.height=e.viewport.height+"px"},width:0,height:0},inner:function(t){var e=t.getBoundingClientRect(),n=e.left+(window.pageXOffset?window.pageXOffset:i.body.scrollLeft),r=e.top+(window.pageYOffset?window.pageYOffset:i.body.scrollTop),s=parseInt(this.getStyle(t,"border-left-width")||0,10)||parseInt(this.getStyle(t,"borderLeftWidth")||0,10)||0,o=parseInt(this.getStyle(t,"border-top-width")||0,10)||parseInt(this.getStyle(t,"borderTopWidth")||0,10)||0;return n+=s,r+=o,{x:n,y:r}},getStyle:function(t,e){var n;return t.currentStyle?n=t.currentStyle[this.camelize(e)]:window.getComputedStyle&&(n=i.defaultView.getComputedStyle(t,null).getPropertyValue(this.csselize(e))),n},camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},csselize:function(t){return t.replace(/[A-Z]/g,function(t){return t?"-"+t.toLowerCase():""})},translate:function(t,n){var r=i.documentElement,s=i.body;return{x:(t-e.stage.x+(r&&r.scrollLeft||s&&s.scrollLeft||0))/e.viewport._scale-e.viewport._x,y:(n-e.stage.y+(r&&r.scrollTop||s&&s.scrollTop||0))/e.viewport._scale-e.viewport._y}}}})},{"./core.js":9}],3:[function(t){var e=t("./core.js"),i=window.document;e.c("DebugCanvas",{init:function(){this.requires("2D"),e.DebugCanvas.context||e.DebugCanvas.init(),e.DebugCanvas.add(this),this._debug={alpha:1,lineWidth:1},this.bind("RemoveComponent",this.onDebugRemove),this.bind("Remove",this.onDebugDestroy)},onDebugRemove:function(t){"DebugCanvas"===t&&e.DebugCanvas.remove(this)},onDebugDestroy:function(){e.DebugCanvas.remove(this)},debugAlpha:function(t){return this._debug.alpha=t,this},debugFill:function(t){return"undefined"==typeof t&&(t="red"),this._debug.fillStyle=t,this},debugStroke:function(t){return"undefined"==typeof t&&(t="red"),this._debug.strokeStyle=t,this},debugDraw:function(t){var e=t.globalAlpha,i=this._debug;i.alpha&&(t.globalAlpha=this._debug.alpha),i.strokeStyle&&(t.strokeStyle=i.strokeStyle),i.lineWidth&&(t.lineWidth=i.lineWidth),i.fillStyle&&(t.fillStyle=i.fillStyle),this.trigger("DebugDraw"),t.globalAlpha=e}}),e.c("DebugRectangle",{init:function(){this.requires("2D, DebugCanvas")},debugRectangle:function(t){return this.debugRect=t,this.unbind("DebugDraw",this.drawDebugRect),this.bind("DebugDraw",this.drawDebugRect),this},drawDebugRect:function(){ctx=e.DebugCanvas.context;var t=this.debugRect;null!==t&&void 0!==t&&t._h&&t._w&&(this._debug.fillStyle&&ctx.fillRect(t._x,t._y,t._w,t._h),this._debug.strokeStyle&&ctx.strokeRect(t._x,t._y,t._w,t._h))}}),e.c("VisibleMBR",{init:function(){this.requires("DebugRectangle").debugFill("purple").bind("EnterFrame",this._assignRect)},_assignRect:function(){this.debugRectangle(this._mbr?this._mbr:this)}}),e.c("DebugPolygon",{init:function(){this.requires("2D, DebugCanvas")},debugPolygon:function(t){return this.polygon=t,this.unbind("DebugDraw",this.drawDebugPolygon),this.bind("DebugDraw",this.drawDebugPolygon),this},drawDebugPolygon:function(){if("undefined"!=typeof this.polygon){ctx=e.DebugCanvas.context,ctx.beginPath();for(var t in this.polygon.points)ctx.lineTo(this.polygon.points[t][0],this.polygon.points[t][1]);ctx.closePath(),this._debug.fillStyle&&ctx.fill(),this._debug.strokeStyle&&ctx.stroke()}}}),e.c("WiredHitBox",{init:function(){this.requires("DebugPolygon").debugStroke("red").matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),e.c("SolidHitBox",{init:function(){this.requires("Collision, DebugPolygon").debugFill("orange").debugAlpha(.7).matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),e.DebugCanvas={context:null,entities:[],onetimeEntities:[],add:function(t){this.entities.push(t)},remove:function(t){for(var e=this.entities,i=e.length-1;i>=0;i--)e[i]==t&&e.splice(i,1)},init:function(){if(!e.DebugCanvas.context){if(!e.support.canvas)return e.trigger("NoCanvas"),void e.stop();var t;t=i.createElement("canvas"),t.width=e.viewport.width,t.height=e.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.id="debug-canvas",t.style.zIndex=1e5,e.stage.elem.appendChild(t),e.DebugCanvas.context=t.getContext("2d"),e.DebugCanvas._canvas=t}e.unbind("RenderScene",e.DebugCanvas.renderScene),e.bind("RenderScene",e.DebugCanvas.renderScene)},renderScene:function(t){t=t||e.viewport.rect();var i,n=e.DebugCanvas.entities,r=0,s=n.length,o=e.DebugCanvas.context,a=e.viewport;for(o.setTransform(a._scale,0,0,a._scale,a._x,a._y),o.clearRect(t._x,t._y,t._w,t._h);s>r;r++)i=n[r],i.debugDraw(o)}}},{"./core.js":9}],4:[function(t,e){function i(t,e,i){this.keys=t,this.map=i,this.obj=e}var n,r=(t("./core.js"),window.document,function(t){n=t||64,this.map={}}),s=" ",o={};r.prototype={insert:function(t){var e,n,s=r.key(t),o=new i(s,t,this),a=0;for(a=s.x1;a<=s.x2;a++)for(e=s.y1;e<=s.y2;e++)n=a<<16^e,this.map[n]||(this.map[n]=[]),this.map[n].push(t);return o},search:function(t,e){var i,n,s,a=r.key(t,o),h=[];for(void 0===e&&(e=!0),i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)if(cell=this.map[i<<16^n])for(s=0;s<cell.length;s++)h.push(cell[s]);if(e){var u,c,f=[],A={};for(i=0,l=h.length;l>i;i++)u=h[i],u&&(c=u[0],u=u._mbr||u,!A[c]&&u._x<t._x+t._w&&u._x+u._w>t._x&&u._y<t._y+t._h&&u._h+u._y>t._y&&(A[c]=h[i]));for(u in A)f.push(A[u]);return f}return h},remove:function(t,e){var i,n,s=0;for(1==arguments.length&&(e=t,t=r.key(e,o)),s=t.x1;s<=t.x2;s++)for(i=t.y1;i<=t.y2;i++)if(n=s<<16^i,this.map[n]){var a,h=this.map[n],l=h.length;for(a=0;l>a;a++)h[a]&&h[a][0]===e[0]&&h.splice(a,1)}},refresh:function(t){var e,i,n,s,o,a=t.keys,h=t.obj;for(i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)if(e=this.map[i<<16^n])for(o=e.length,s=0;o>s;s++)e[s]&&e[s][0]===h[0]&&e.splice(s,1);for(r.key(h,a),i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)e=this.map[i<<16^n],e||(e=this.map[i<<16^n]=[]),e.push(h);return t},boundaries:function(){var t,e,i={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}},n={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}};for(var r in this.map)if(this.map[r].length){var s=r>>16,o=r<<16>>16;if(0>o&&(s=-1^s),s>=i.max.x){i.max.x=s;for(t in this.map[r])e=this.map[r][t],"object"==typeof e&&"requires"in e&&(n.max.x=Math.max(n.max.x,e.x+e.w))}if(s<=i.min.x){i.min.x=s;for(t in this.map[r])e=this.map[r][t],"object"==typeof e&&"requires"in e&&(n.min.x=Math.min(n.min.x,e.x))}if(o>=i.max.y){i.max.y=o;for(t in this.map[r])e=this.map[r][t],"object"==typeof e&&"requires"in e&&(n.max.y=Math.max(n.max.y,e.y+e.h))}if(o<=i.min.y){i.min.y=o;for(t in this.map[r])e=this.map[r][t],"object"==typeof e&&"requires"in e&&(n.min.y=Math.min(n.min.y,e.y))}}return n}},r.key=function(t,e){return t._mbr&&(t=t._mbr),e||(e={}),e.x1=Math.floor(t._x/n),e.y1=Math.floor(t._y/n),e.x2=Math.floor((t._w+t._x)/n),e.y2=Math.floor((t._h+t._y)/n),e},r.hash=function(t){return t.x1+s+t.y1+s+t.x2+s+t.y2},i.prototype={update:function(t){r.hash(r.key(t,o))!=r.hash(this.keys)&&this.map.refresh(this)}},e.exports=r},{"./core.js":9}],5:[function(t){{var e=t("./core.js");window.document}e.easing=function(t){this.timePerFrame=1e3/e.timer.FPS(),this.duration=t,this.reset()},e.easing.prototype={duration:0,clock:0,steps:null,complete:!1,paused:!1,reset:function(){this.loops=1,this.clock=0,this.complete=!1,this.paused=!1},repeat:function(t){this.loops=t},setProgress:function(t,e){this.clock=this.duration*t,"undefined"!=typeof e&&(this.loops=e)},pause:function(){this.paused=!0},resume:function(){this.paused=!1,this.complete=!1},tick:function(t){if(!this.paused&&!this.complete)for(this.clock+=t,this.frames=Math.floor(this.clock/this.timePerFrame);this.clock>=this.duration&&this.complete===!1;)this.loops--,this.loops>0?this.clock-=this.duration:this.complete=!0},time:function(){return Math.min(this.clock/this.duration,1)},value:function(){return this.time()}},e.c("Tween",{init:function(){this.tweenGroup={},this.tweenStart={},this.tweens=[],this.bind("EnterFrame",this._tweenTick)},_tweenTick:function(t){var e,i,n;for(n=this.tweens.length-1;n>=0;n--)e=this.tweens[n],e.easing.tick(t.dt),i=e.easing.value(),this._doTween(e.props,i),e.easing.complete&&(this.tweens.splice(n,1),this._endTween(e.props))},_doTween:function(t,e){for(var i in t)this[i]=(1-e)*this.tweenStart[i]+e*t[i]},tween:function(t,i){var n={props:t,easing:new e.easing(i)};for(var r in t)"undefined"!=typeof this.tweenGroup[r]&&this.cancelTween(r),this.tweenStart[r]=this[r],this.tweenGroup[r]=t;return this.tweens.push(n),this},cancelTween:function(t){if("string"==typeof t)"object"==typeof this.tweenGroup[t]&&delete this.tweenGroup[t][t];else if("object"==typeof t)for(var e in t)this.cancelTween(e);return this},_endTween:function(t){for(var e in t)delete this.tweenGroup[e];this.trigger("TweenEnd",t)}})},{"./core.js":9}],6:[function(t){var e=t("./core.js"),i=window.document;e.c("Canvas",{init:function(){e.canvas.context||e.canvas.init(),e.DrawManager.total2D++,this.currentRect={},this._changed=!0,e.DrawManager.addCanvas(this),this.bind("Invalidate",function(){this._changed===!1&&(this._changed=!0,e.DrawManager.addCanvas(this))}),this.bind("Remove",function(){e.DrawManager.total2D--,this._changed=!0,e.DrawManager.addCanvas(this)})},drawVars:{type:"canvas",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,i,n,r,s){if(this.ready){4===arguments.length&&(s=r,r=n,n=i,i=t,t=e.canvas.context);var o=this.drawVars.pos;o._x=this._x+(i||0),o._y=this._y+(n||0),o._w=r||this._w,o._h=s||this._h,context=t||e.canvas.context,coord=this.__coord||[0,0,0,0];var a=this.drawVars.co;a.x=coord[0]+(i||0),a.y=coord[1]+(n||0),a.w=r||coord[2],a.h=s||coord[3],0!==this._rotation&&(context.save(),context.translate(this._origin.x+this._x,this._origin.y+this._y),o._x=-this._origin.x,o._y=-this._origin.y,context.rotate(this._rotation%360*(Math.PI/180))),(this._flipX||this._flipY)&&(context.save(),context.scale(this._flipX?-1:1,this._flipY?-1:1),this._flipX&&(o._x=-(o._x+o._w)),this._flipY&&(o._y=-(o._y+o._h)));var h;return this._alpha<1&&(h=context.globalAlpha,context.globalAlpha=this._alpha),this.drawVars.ctx=context,this.trigger("Draw",this.drawVars),(0!==this._rotation||this._flipX||this._flipY)&&context.restore(),h&&(context.globalAlpha=h),this}}}),e.extend({canvas:{context:null,init:function(){if(!e.support.canvas)return e.trigger("NoCanvas"),void e.stop();var t;t=i.createElement("canvas"),t.width=e.viewport.width,t.height=e.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",e.stage.elem.appendChild(t),e.canvas.context=t.getContext("2d"),e.canvas._canvas=t;var n=e.viewport._scale;1!=n&&e.canvas.context.scale(n,n),e.uniqueBind("RenderScene",e.DrawManager.renderCanvas),e.uniqueBind("ViewportResize",this._resize)},_resize:function(){var t=e.canvas._canvas;t.width=e.viewport.width,t.height=e.viewport.height}}})},{"./core.js":9}],7:[function(t){var e=t("./core.js"),i=(window.document,Math.PI/180);e.c("Collision",{init:function(){this.requires("2D"),this.collision()},remove:function(){this._cbr=null,this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds)},collision:function(t){if(this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds),t){if(arguments.length>1){var n=Array.prototype.slice.call(arguments,0);t=new e.polygon(n)}this._findBounds(t.points)}else t=new e.polygon([0,0],[this._w,0],[this._w,this._h],[0,this._h]),this.bind("Resize",this._resizeMap),this._cbr=null;return this.rotation&&t.rotate({cos:Math.cos(-this.rotation*i),sin:Math.sin(-this.rotation*i),o:{x:this._origin.x,y:this._origin.y}}),this.map=t,this.attach(this.map),this.map.shift(this._x,this._y),this.trigger("NewHitbox",t),this},_findBounds:function(t){for(var e,i=1/0,n=-1/0,r=1/0,s=-1/0,o=0;o<t.length;++o)e=t[o],e[0]<i&&(i=e[0]),e[0]>n&&(n=e[0]),e[1]<r&&(r=e[1]),e[1]>s&&(s=e[1]);var a={cx:(i+n)/2,cy:(r+s)/2,r:Math.sqrt((n-i)*(n-i)+(s-r)*(s-r))/2};return i>=0&&r>=0&&(this._checkBounds=function(){null===this._cbr&&this._w<n||this._h<s?(this._cbr=a,this._calculateMBR()):this._cbr&&(this._cbr=null,this._calculateMBR())},this.bind("Resize",this._checkBounds)),i>=0&&r>=0&&n<=this._w&&s<=this._h?(this._cbr=null,!1):(this._cbr=a,this._calculateMBR(),!0)},_resizeMap:function(t){var e,n,r=this.rotation*i,s=this.map.points;"w"===t.axis?(r?(e=t.amount*Math.cos(r),n=t.amount*Math.sin(r)):(e=t.amount,n=0),s[1][0]+=e,s[1][1]+=n):(r?(n=t.amount*Math.cos(r),e=-t.amount*Math.sin(r)):(e=0,n=t.amount),s[3][0]+=e,s[3][1]+=n),s[2][0]+=e,s[2][1]+=n},hit:function(t){var i,n,r,s,o=this._cbr||this._mbr||this,a=e.map.search(o,!1),h=0,l=a.length,u={},c="map"in this&&"containsPoint"in this.map,f=[];if(!l)return!1;for(;l>h;++h)n=a[h],r=n._cbr||n._mbr||n,n&&(i=n[0],!u[i]&&this[0]!==i&&n.__c[t]&&r._x<o._x+o._w&&r._x+r._w>o._x&&r._y<o._y+o._h&&r._h+r._y>o._y&&(u[i]=n));for(s in u)if(n=u[s],c&&"map"in n){var A=this._SAT(this.map,n.map);A.obj=n,A.type="SAT",A&&f.push(A)}else f.push({obj:n,type:"MBR"});return f.length?f:!1},onHit:function(t,e,i){var n=!1;return this.bind("EnterFrame",function(){var r=this.hit(t);r?(n=!0,e.call(this,r)):n&&("function"==typeof i&&i.call(this),n=!1)}),this},_SAT:function(t,e){for(var i,n,r,s,o,a,h,l,u,c,f=t.points,A=e.points,d=0,g=f.length,m=A.length,p={x:0,y:0},_=null,x=null,y=null;g>d;d++){for(u=f[d==g-1?0:d+1],c=f[d],p.x=-(u[1]-c[1]),p.y=u[0]-c[0],n=Math.sqrt(p.x*p.x+p.y*p.y),p.x/=n,p.y/=n,r=s=-1,o=a=-1,i=0;g>i;++i)l=f[i][0]*p.x+f[i][1]*p.y,(l>o||-1===o)&&(o=l),(r>l||-1===r)&&(r=l);for(i=0;m>i;++i)l=A[i][0]*p.x+A[i][1]*p.y,(l>a||-1===a)&&(a=l),(s>l||-1===s)&&(s=l);if(s>r?(h=s-o,p.x=-p.x,p.y=-p.y):h=r-a,h>=0)return!1;(null===_||h>_)&&(_=h,y={x:p.x,y:p.y})}for(d=0;m>d;d++){for(u=A[d==m-1?0:d+1],c=A[d],p.x=-(u[1]-c[1]),p.y=u[0]-c[0],n=Math.sqrt(p.x*p.x+p.y*p.y),p.x/=n,p.y/=n,r=s=-1,o=a=-1,i=0;g>i;++i)l=f[i][0]*p.x+f[i][1]*p.y,(l>o||-1===o)&&(o=l),(r>l||-1===r)&&(r=l);for(i=0;m>i;++i)l=A[i][0]*p.x+A[i][1]*p.y,(l>a||-1===a)&&(a=l),(s>l||-1===s)&&(s=l);if(s>r?(h=s-o,p.x=-p.x,p.y=-p.y):h=r-a,h>=0)return!1;(null===_||h>_)&&(_=h),(h>x||null===x)&&(x=h,y={x:p.x,y:p.y})}return{overlap:x,normal:y}}})},{"./core.js":9}],8:[function(t){var e=t("./core.js"),i=window.document;e.extend({over:null,mouseObjs:0,mousePos:{},lastEvent:null,keydown:{},selected:!1,detectBlur:function(t){var i=t.clientX>e.stage.x&&t.clientX<e.stage.x+e.viewport.width&&t.clientY>e.stage.y&&t.clientY<e.stage.y+e.viewport.height;!e.selected&&i&&e.trigger("CraftyFocus"),e.selected&&!i&&e.trigger("CraftyBlur"),e.selected=i},mouseDispatch:function(t){if(e.mouseObjs){e.lastEvent=t;var i,n,r,s,o,a=-1,h=0,l=e.DOM.translate(t.clientX,t.clientY),u={},c=t.target?t.target:t.srcElement,f=t.type;if(t.mouseButton="undefined"==typeof t.which?t.button<2?e.mouseButtons.LEFT:4==t.button?e.mouseButtons.MIDDLE:e.mouseButtons.RIGHT:t.which<2?e.mouseButtons.LEFT:2==t.which?e.mouseButtons.MIDDLE:e.mouseButtons.RIGHT,t.realX=s=e.mousePos.x=l.x,t.realY=o=e.mousePos.y=l.y,"CANVAS"!=c.nodeName){for(;"string"!=typeof c.id&&-1==c.id.indexOf("ent");)c=c.parentNode;ent=e(parseInt(c.id.replace("ent",""),10)),ent.has("Mouse")&&ent.isAt(s,o)&&(i=ent)}if(!i)for(n=e.map.search({_x:s,_y:o,_w:1,_h:1},!1),r=n.length;r>h;++h)if(n[h].__c.Mouse&&n[h]._visible){var A=n[h],d=!1;if(!u[A[0]]&&(u[A[0]]=!0,A.mapArea?A.mapArea.containsPoint(s,o)&&(d=!0):A.isAt(s,o)&&(d=!0),d&&(A._z>=a||-1===a))){if(A._z===a&&A[0]<i[0])continue;a=A._z,i=A}}i?"mousedown"===f?i.trigger("MouseDown",t):"mouseup"===f?i.trigger("MouseUp",t):"dblclick"==f?i.trigger("DoubleClick",t):"click"==f?i.trigger("Click",t):"mousemove"===f?(i.trigger("MouseMove",t),this.over!==i&&(this.over&&(this.over.trigger("MouseOut",t),this.over=null),this.over=i,i.trigger("MouseOver",t))):i.trigger(f,t):("mousemove"===f&&this.over&&(this.over.trigger("MouseOut",t),this.over=null),"mousedown"===f?e.viewport.mouselook("start",t):"mousemove"===f?e.viewport.mouselook("drag",t):"mouseup"==f&&e.viewport.mouselook("stop")),"mousemove"===f&&(this.lastEvent=t)}},touchDispatch:function(t){var n,r=e.lastEvent;"touchstart"===t.type?n="mousedown":"touchmove"===t.type?n="mousemove":"touchend"===t.type?n="mouseup":"touchcancel"===t.type?n="mouseup":"touchleave"===t.type&&(n="mouseup"),t.touches&&t.touches.length?first=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(first=t.changedTouches[0]);var s=i.createEvent("MouseEvent");s.initMouseEvent(n,!0,!0,window,1,first.screenX,first.screenY,first.clientX,first.clientY,!1,!1,!1,!1,0,t.relatedTarget),first.target.dispatchEvent(s),null!==r&&"mousedown"==r.type&&"mouseup"==n&&(n="click",s=i.createEvent("MouseEvent"),s.initMouseEvent(n,!0,!0,window,1,first.screenX,first.screenY,first.clientX,first.clientY,!1,!1,!1,!1,0,t.relatedTarget),first.target.dispatchEvent(s)),t.target&&"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},keyboardDispatch:function(t){for(var i=t,n={},r="char charCode keyCode type shiftKey ctrlKey metaKey timestamp".split(" "),s=r.length;s;){var o=r[--s];n[o]=i[o]}return n.which=null!==i.charCode?i.charCode:i.keyCode,n.key=i.keyCode||i.which,n.originalEvent=i,t=n,"keydown"===t.type?e.keydown[t.key]!==!0&&(e.keydown[t.key]=!0,e.trigger("KeyDown",t)):"keyup"===t.type&&(delete e.keydown[t.key],e.trigger("KeyUp",t)),e.selected&&!(8==t.key||t.key>=112&&t.key<=135)?(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.target&&"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&(t.preventDefault?t.preventDefault():t.returnValue=!1),!1):void 0}}),e.bind("Load",function(){e.addEvent(this,"keydown",e.keyboardDispatch),e.addEvent(this,"keyup",e.keyboardDispatch),e.addEvent(this,e.stage.elem,"mousedown",e.mouseDispatch),e.addEvent(this,e.stage.elem,"mouseup",e.mouseDispatch),e.addEvent(this,i.body,"mouseup",e.detectBlur),e.addEvent(this,e.stage.elem,"mousemove",e.mouseDispatch),e.addEvent(this,e.stage.elem,"click",e.mouseDispatch),e.addEvent(this,e.stage.elem,"dblclick",e.mouseDispatch),e.addEvent(this,e.stage.elem,"touchstart",e.touchDispatch),e.addEvent(this,e.stage.elem,"touchmove",e.touchDispatch),e.addEvent(this,e.stage.elem,"touchend",e.touchDispatch),e.addEvent(this,e.stage.elem,"touchcancel",e.touchDispatch),e.addEvent(this,e.stage.elem,"touchleave",e.touchDispatch)
}),e.bind("CraftyStop",function(){e.removeEvent(this,"keydown",e.keyboardDispatch),e.removeEvent(this,"keyup",e.keyboardDispatch),e.stage&&(e.removeEvent(this,e.stage.elem,"mousedown",e.mouseDispatch),e.removeEvent(this,e.stage.elem,"mouseup",e.mouseDispatch),e.removeEvent(this,e.stage.elem,"mousemove",e.mouseDispatch),e.removeEvent(this,e.stage.elem,"click",e.mouseDispatch),e.removeEvent(this,e.stage.elem,"dblclick",e.mouseDispatch),e.removeEvent(this,e.stage.elem,"touchstart",e.touchDispatch),e.removeEvent(this,e.stage.elem,"touchmove",e.touchDispatch),e.removeEvent(this,e.stage.elem,"touchend",e.touchDispatch),e.removeEvent(this,e.stage.elem,"touchcancel",e.touchDispatch),e.removeEvent(this,e.stage.elem,"touchleave",e.touchDispatch)),e.removeEvent(this,i.body,"mouseup",e.detectBlur)}),e.c("Mouse",{init:function(){e.mouseObjs++,this.bind("Remove",function(){e.mouseObjs--})},areaMap:function(t){if(arguments.length>1){var i=Array.prototype.slice.call(arguments,0);t=new e.polygon(i)}return t.shift(this._x,this._y),this.mapArea=t,this.attach(this.mapArea),this}}),e.c("Draggable",{_origMouseDOMPos:null,_oldX:null,_oldY:null,_dragging:!1,_dir:null,init:function(){this.requires("Mouse"),this.enableDrag()},_ondrag:function(t){var i=e.DOM.translate(t.clientX,t.clientY);if(0===i.x||0===i.y)return!1;if(this._dir){var n=(i.x-this._origMouseDOMPos.x)*this._dir.x+(i.y-this._origMouseDOMPos.y)*this._dir.y;this.x=this._oldX+n*this._dir.x,this.y=this._oldY+n*this._dir.y}else this.x=this._oldX+(i.x-this._origMouseDOMPos.x),this.y=this._oldY+(i.y-this._origMouseDOMPos.y);this.trigger("Dragging",t)},_ondown:function(t){t.mouseButton===e.mouseButtons.LEFT&&this._startDrag(t)},_onup:function(t){this._dragging===!0&&(e.removeEvent(this,e.stage.elem,"mousemove",this._ondrag),e.removeEvent(this,e.stage.elem,"mouseup",this._onup),this._dragging=!1,this.trigger("StopDrag",t))},dragDirection:function(t){if("undefined"==typeof t)this._dir=null;else if(""+parseInt(t,10)==t)this._dir={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};else{var e=Math.sqrt(t.x*t.x+t.y*t.y);this._dir={x:t.x/e,y:t.y/e}}},_startDrag:function(t){this._origMouseDOMPos=e.DOM.translate(t.clientX,t.clientY),this._oldX=this._x,this._oldY=this._y,this._dragging=!0,e.addEvent(this,e.stage.elem,"mousemove",this._ondrag),e.addEvent(this,e.stage.elem,"mouseup",this._onup),this.trigger("StartDrag",t)},stopDrag:function(){return e.removeEvent(this,e.stage.elem,"mousemove",this._ondrag),e.removeEvent(this,e.stage.elem,"mouseup",this._onup),this._dragging=!1,this.trigger("StopDrag"),this},startDrag:function(){return this._dragging||this._startDrag(e.lastEvent),this},enableDrag:function(){return this.bind("MouseDown",this._ondown),e.addEvent(this,e.stage.elem,"mouseup",this._onup),this},disableDrag:function(){return this.unbind("MouseDown",this._ondown),this._dragging&&this.stopDrag(),this}}),e.c("Keyboard",{isDown:function(t){return"string"==typeof t&&(t=e.keys[t]),!!e.keydown[t]}}),e.c("Multiway",{_speed:3,_keydown:function(t){this._keys[t.key]&&(this._movement.x=Math.round(1e3*(this._movement.x+this._keys[t.key].x))/1e3,this._movement.y=Math.round(1e3*(this._movement.y+this._keys[t.key].y))/1e3,this.trigger("NewDirection",this._movement))},_keyup:function(t){this._keys[t.key]&&(this._movement.x=Math.round(1e3*(this._movement.x-this._keys[t.key].x))/1e3,this._movement.y=Math.round(1e3*(this._movement.y-this._keys[t.key].y))/1e3,this.trigger("NewDirection",this._movement))},_enterframe:function(){this.disableControls||(0!==this._movement.x&&(this.x+=this._movement.x,this.trigger("Moved",{x:this.x-this._movement.x,y:this.y})),0!==this._movement.y&&(this.y+=this._movement.y,this.trigger("Moved",{x:this.x,y:this.y-this._movement.y})))},_initializeControl:function(){return this.unbind("KeyDown",this._keydown).unbind("KeyUp",this._keyup).unbind("EnterFrame",this._enterframe).bind("KeyDown",this._keydown).bind("KeyUp",this._keyup).bind("EnterFrame",this._enterframe)},multiway:function(t,i){this._keyDirection={},this._keys={},this._movement={x:0,y:0},this._speed={x:3,y:3},i?void 0!==t.x&&void 0!==t.y?(this._speed.x=t.x,this._speed.y=t.y):(this._speed.x=t,this._speed.y=t):i=t,this._keyDirection=i,this.speed(this._speed),this._initializeControl();for(var n in i)e.keydown[e.keys[n]]&&this.trigger("KeyDown",{key:e.keys[n]});return this},enableControl:function(){return this.disableControls=!1,this},disableControl:function(){return this.disableControls=!0,this},speed:function(t){for(var i in this._keyDirection){var n=e.keys[i]||i;this._keys[n]={x:Math.round(1e3*Math.cos(this._keyDirection[i]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._keyDirection[i]*(Math.PI/180))*t.y)/1e3}}return this}}),e.c("Fourway",{init:function(){this.requires("Multiway")},fourway:function(t){return this.multiway(t,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180,W:-90,S:90,D:0,A:180,Z:-90,Q:180}),this}}),e.c("Twoway",{_speed:3,_up:!1,init:function(){this.requires("Fourway, Keyboard, Gravity")},twoway:function(t,i){return this.multiway(t,{RIGHT_ARROW:0,LEFT_ARROW:180,D:0,A:180,Q:180}),t&&(this._speed=t),this._jumpSpeed=arguments.length<2?2*this._speed:i,this.bind("EnterFrame",function(){this.disableControls||this._up&&(this.y-=this._jumpSpeed,this._falling=!0,this.trigger("Moved",{x:this._x,y:this._y+this._jumpSpeed}))}).bind("KeyDown",function(t){this._falling||t.key!==e.keys.UP_ARROW&&t.key!==e.keys.W&&t.key!==e.keys.Z||(this._up=!0)}),this}})},{"./core.js":9}],9:[function(t,e){function i(){var t=r++;return t in a?i():t}function n(t){if(null===t||"object"!=typeof t)return t;var e=t.constructor();for(var i in t)e[i]=n(t[i]);return e}var r,s,o,a,h,l,u,c,f,A=t("./version"),d=function(t){return new d.fn.init(t)};initState=function(){r=1,s=0,o={},a={},h={},l=[],u=Array.prototype.slice,c=/\s*,\s*/,f=/\s+/},initState(),d.fn=d.prototype={init:function(t){if("string"!=typeof t)return t||(t=0,t in a||(a[t]=this)),t in a?(this[0]=t,this.length=1,this.__c||(this.__c={}),a[t]||(a[t]=this),a[t]):(this.length=0,this);var e,i,n,r,s,h,l,u=0,A=!1,d=!1;if("*"===t){h=0;for(e in a)this[h]=+e,h++;return this.length=h,1===h?a[this[0]]:this}-1!==t.indexOf(",")?(d=!0,n=c):-1!==t.indexOf(" ")&&(A=!0,n=f);for(e in a)if(a.hasOwnProperty(e))if(i=a[e],A||d){for(r=t.split(n),h=0,l=r.length,s=0;l>h;h++)i.__c[r[h]]&&s++;(A&&s===l||d&&s>0)&&(this[u++]=+e)}else i.__c[t]&&(this[u++]=+e);if(u>0&&!A&&!d&&this.extend(o[t]),r&&A)for(h=0;l>h;h++)this.extend(o[r[h]]);return this.length=u,1===u?a[this[u-1]]:this},setName:function(t){var e=String(t);return this._entityName=e,this.trigger("NewEntityName",e),this},addComponent:function(t){var e,i,n,r,s=[],a=0,h=0;if(arguments.length>1)for(i=arguments.length;i>h;h++)s.push(arguments[h]);else if(-1!==t.indexOf(","))for(n=t.split(c),i=n.length;i>h;h++)s.push(n[h]);else s.push(t);for(e=s.length;e>a;a++)this.__c[s[a]]!==!0&&(this.__c[s[a]]=!0,r=o[s[a]],this.extend(r),r&&"init"in r&&r.init.call(this));return this.trigger("NewComponent",s),this},toggleComponent:function(t){var e,i,n=0;if(arguments.length>1)for(e=arguments.length;e>n;n++)this.has(arguments[n])?this.removeComponent(arguments[n]):this.addComponent(arguments[n]);else if(-1!==t.indexOf(","))for(i=t.split(c),e=i.length;e>n;n++)this.has(i[n])?this.removeComponent(i[n]):this.addComponent(i[n]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(t){return this.addComponent(t)},removeComponent:function(t,e){var i=o[t];if(this.trigger("RemoveComponent",t),i&&"remove"in i&&i.remove.call(this,!1),e===!1&&i)for(var n in i)delete this[n];return delete this.__c[t],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e){if(1===arguments.length)return"string"==typeof t?this[t]:(this.extend(t),this.trigger("Change",t),this);this[t]=e;var i={};return i[t]=e,this.trigger("Change",i),this},toArray:function(){return u.call(this,0)},timeout:function(t,e){return this.each(function(){var i=this;setTimeout(function(){t.call(i)},e)}),this},bind:function(t,e){if(1===this.length){h[t]||(h[t]={});var i=h[t];return i[this[0]]||(i[this[0]]=[]),i[this[0]].push(e),this}return this.each(function(){h[t]||(h[t]={});var i=h[t];i[this[0]]||(i[this[0]]=[]),i[this[0]].push(e)}),this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){return this.each(function(){var i,n,r=h[t],s=0;if(!r||!r[this[0]])return this;if(i=r[this[0]].length,!e)return delete r[this[0]],this;for(;i>s;s++)n=r[this[0]],n[s]==e&&delete n[s]}),this},trigger:function(t,e){if(1===this.length){if(h[t]&&h[t][this[0]]){var i,n=h[t][this[0]];for(i=0;i<n.length;i++)"undefined"==typeof n[i]?(n.splice(i,1),i--):n[i].call(this,e)}return this}return this.each(function(){if(h[t]&&h[t][this[0]]){var i,n=h[t][this[0]];for(i=0;i<n.length;i++)"undefined"==typeof n[i]?(n.splice(i,1),i--):n[i].call(this,e)}}),this},each:function(t){for(var e=0,i=this.length;i>e;e++)a[this[e]]&&t.call(a[this[e]],e);return this},get:function(t){var e=this.length;if("undefined"!=typeof t)return t>=e||0>t+e?void 0:t>=0?a[this[t]]:a[this[t+e]];for(var i=0,n=[];e>i;i++)a[this[i]]&&n.push(a[this[i]]);return n},clone:function(){var t,e,i=this.__c,n=d.e();for(t in i)n.addComponent(t);for(e in this)"0"!=e&&"_global"!=e&&"_changed"!=e&&"function"!=typeof this[e]&&"object"!=typeof this[e]&&(n[e]=this[e]);return n},setter:function(t,e){return d.support.setter?this.__defineSetter__(t,e):d.support.defineProperty&&Object.defineProperty(this,t,{set:e,configurable:!0}),this},destroy:function(){this.each(function(){var t;this.trigger("Remove");for(var e in this.__c)t=o[e],t&&"remove"in t&&t.remove.call(this,!0);for(var i in h)this.unbind(i);delete a[this[0]]})}},d.fn.init.prototype=d.fn,d.extend=d.fn.extend=function(t){var e,i=this;if(!t)return i;for(e in t)i!==t[e]&&(i[e]=t[e]);return i},d.extend({init:function(t,e,i){return d.viewport.init(t,e,i),this.trigger("Load"),this.timer.init(),this},getVersion:function(){return A},stop:function(t){if(this.timer.stop(),t){if(d.audio.remove(),d.stage&&d.stage.elem.parentNode){var e=document.createElement("div");e.id=d.stage.elem.id,d.stage.elem.parentNode.replaceChild(e,d.stage.elem)}initState()}return d.trigger("CraftyStop"),this},pause:function(t){return(1===arguments.length?t:!this._paused)?(this.trigger("Pause"),this._paused=!0,setTimeout(function(){d.timer.stop()},0),d.keydown={}):(this.trigger("Unpause"),this._paused=!1,setTimeout(function(){d.timer.init()},0)),this},isPaused:function(){return this._paused},timer:function(){var t,e,i,n="fixed",r=5,o=40,a=0,h=0,l=50,u=1e3/l;return{init:function(){"undefined"==typeof i&&(i=(new Date).getTime()-u);var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null;n?(t=function(){d.timer.step(),e=n(t)})():t=setInterval(function(){d.timer.step()},1e3/l)},stop:function(){d.trigger("CraftyStopTimer"),"number"==typeof t&&clearInterval(t);var i=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null;i&&i(e),t=null},steptype:function(t,e){if("variable"===t||"semifixed"===t)n=t,e&&(o=e);else{if("fixed"!==t)throw"Invalid step type specified";n="fixed",e&&(r=e)}},step:function(){var t,e,l,c=0;if(currentTime=(new Date).getTime(),a>0&&d.trigger("MeasureWaitTime",currentTime-a),i+h>=currentTime)return void(a=currentTime);var f=currentTime-(i+h);f>20*u&&(h+=f-u,f=u),"fixed"===n?(c=Math.ceil(f/u),c=Math.min(c,r),e=u):"variable"===n?(c=1,e=f,e=Math.min(e,o)):"semifixed"===n&&(c=Math.ceil(f/o),e=f/c);for(var A=0;c>A;A++)l=currentTime,d.trigger("EnterFrame",{frame:s++,dt:e,gameTime:i}),i+=e,currentTime=(new Date).getTime(),d.trigger("MeasureFrameTime",currentTime-l);c>0&&(t=currentTime,d.trigger("RenderScene"),d.trigger("PostRender"),currentTime=(new Date).getTime(),d.trigger("MeasureRenderTime",currentTime-t)),a=currentTime},FPS:function(t){return"undefined"==typeof t?l:(l=t,void(u=1e3/l))},simulateFrames:function(t,e){for("undefined"==typeof e&&(e=u);t-->0;)d.trigger("EnterFrame",{frame:s++,dt:e});d.trigger("RenderScene")}}}(),e:function(){var t,e=i();return a[e]=null,a[e]=t=d(e),arguments.length>0&&t.addComponent.apply(t,arguments),t.setName("Entity #"+e),t.addComponent("obj"),d.trigger("NewEntity",{id:e}),t},c:function(t,e){o[t]=e},trigger:function(t,e){var i,n,r,s,o=h[t];for(i in o)if(o.hasOwnProperty(i)&&(r=o[i],r&&0!==r.length))for(s=a[i]?d(+i):d,n=0;n<r.length;n++)"undefined"==typeof r[n]?(r.splice(n,1),n--):r[n].call(s,e)},bind:function(t,e){h[t]||(h[t]={});var i=h[t];return i.global||(i.global=[]),i.global.push(e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){var i,n,r,s,o=h[t];if(void 0===o||void 0===o.global||0===o.global.length)return!1;if(1===arguments.length)return delete o.global,!0;for(r=o.global,s=!1,i=0,n=r.length;n>i;i++)r[i]===e&&(s=!0,delete r[i]);return s},frame:function(){return s},components:function(){return o},isComp:function(t){return t in o},debug:function(t){return"handlers"===t?h:a},settings:function(){var t={},e={};return{register:function(t,i){e[t]=i},modify:function(i,n){e[i]&&(e[i].call(t[i],n),t[i]=n)},get:function(e){return t[e]}}}(),clone:n}),"function"==typeof define&&define("crafty",[],function(){return d}),e.exports=d,window.Crafty=d},{"./version":28}],10:[function(t){{var e=t("./core.js");window.document}e.extend({device:{_deviceOrientationCallback:!1,_deviceMotionCallback:!1,_normalizeDeviceOrientation:function(t){var i;window.DeviceOrientationEvent?i={tiltLR:t.gamma,tiltFB:t.beta,dir:t.alpha,motUD:null}:window.OrientationEvent&&(i={tiltLR:90*t.x,tiltFB:-90*t.y,dir:null,motUD:t.z}),e.device._deviceOrientationCallback(i)},_normalizeDeviceMotion:function(t){var i=t.accelerationIncludingGravity,n=i.z>0?1:-1,r={acceleration:i,rawAcceleration:"["+Math.round(i.x)+", "+Math.round(i.y)+", "+Math.round(i.z)+"]",facingUp:n,tiltLR:Math.round(i.x/9.81*-90),tiltFB:Math.round((i.y+9.81)/9.81*90*n)};e.device._deviceMotionCallback(r)},deviceOrientation:function(t){this._deviceOrientationCallback=t,e.support.deviceorientation&&(window.DeviceOrientationEvent?e.addEvent(this,window,"deviceorientation",this._normalizeDeviceOrientation):window.OrientationEvent&&e.addEvent(this,window,"MozOrientation",this._normalizeDeviceOrientation))},deviceMotion:function(t){this._deviceMotionCallback=t,e.support.devicemotion&&window.DeviceMotionEvent&&e.addEvent(this,window,"devicemotion",this._normalizeDeviceMotion)}}})},{"./core.js":9}],11:[function(t){{var e=t("./core.js");window.document}e.extend({diamondIso:{_tile:{width:0,height:0,r:0},_map:{width:0,height:0,x:0,y:0},_origin:{x:0,y:0},init:function(t,e,i,n){return this._tile.width=parseInt(t,10),this._tile.height=parseInt(e,10)||parseInt(t,10)/2,this._tile.r=this._tile.width/this._tile.height,this._map.width=parseInt(i,10),this._map.height=parseInt(n,10)||parseInt(i,10),this._origin.x=this._map.height*this._tile.width/2,this},place:function(t,e,i,n){var r=this.pos2px(e,i);n||(n=1);var s=0,o=0;void 0!==t.__margin&&(s=t.__margin[0],o=t.__margin[1]),t.x=r.left+s,t.y=r.top+o-t.h,t.z=r.top*n},centerAt:function(t,i){var n=this.pos2px(t,i);e.viewport.x=-n.left+e.viewport.width/2-this._tile.width,e.viewport.y=-n.top+e.viewport.height/2},area:function(t){t||(t=0);var i=e.viewport.rect(),n=i._x,r=i._y,s=i._w,o=i._h,a=t*this._tile.width,h=t*this._tile.height;n-=this._tile.width/2+a,r-=this._tile.height/2+h,s+=this._tile.width/2+a,o+=this._tile.height/2+h;var l=[];for(yl=r+o;yl>r;r+=this._tile.height/2)for(xl=n+s;xl>n;n+=this._tile.width/2){var u=this.px2pos(n,r);l.push([~~u.x,~~u.y])}return l},pos2px:function(t,e){return{left:(t-e)*this._tile.width/2+this._origin.x,top:(t+e)*this._tile.height/2}},px2pos:function(t,e){var i=(t-this._origin.x)/this._tile.r;return{x:(e+i)/this._tile.height,y:(e-i)/this._tile.height}},polygon:function(t){t.requires("Collision");var i=0,n=0;void 0!==t.__margin&&(i=t.__margin[0],n=t.__margin[1]);var r=[[i-0,t.h-n-this._tile.height/2],[i-this._tile.width/2,t.h-n-0],[i-this._tile.width,t.h-n-this._tile.height/2],[i-this._tile.width/2,t.h-n-this._tile.height]],s=new e.polygon(r);return s}}})},{"./core.js":9}],12:[function(t){{var e=t("./core.js");window.document}e.c("Color",{_color:"",ready:!0,init:function(){this.bind("Draw",function(t){"DOM"===t.type?(t.style.backgroundColor=this._color,t.style.lineHeight=0):"canvas"===t.type&&(this._color&&(t.ctx.fillStyle=this._color),t.ctx.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h))})},color:function(t){return t?(this._color=t,this.trigger("Invalidate"),this):this._color}}),e.c("Tint",{_color:null,_strength:1,init:function(){var t=function(t){var i=t.ctx||e.canvas.context;i.fillStyle=this._color||"rgba(0,0,0, 0)",i.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h)};this.bind("Draw",t).bind("RemoveComponent",function(e){"Tint"===e&&this.unbind("Draw",t)})},tint:function(t,i){return this._strength=i,this._color=e.toRGB(t,this._strength),this.trigger("Invalidate"),this}}),e.c("Image",{_repeat:"repeat",ready:!1,init:function(){var t=function(t){if("canvas"===t.type){if(!this.ready||!this._pattern)return;var e=t.ctx;e.fillStyle=this._pattern,e.save(),e.translate(t.pos._x,t.pos._y),e.fillRect(0,0,this._w,this._h),e.restore()}else"DOM"===t.type&&this.__image&&(t.style.backgroundImage="url("+this.__image+")",t.style.backgroundRepeat=this._repeat)};this.bind("Draw",t).bind("RemoveComponent",function(e){"Image"===e&&this.unbind("Draw",t)})},image:function(t,i){if(this.__image=t,this._repeat=i||"no-repeat",this.img=e.asset(t),!this.img){this.img=new Image,e.asset(t,this.img),this.img.src=t;var n=this;return this.img.onload=function(){n.has("Canvas")&&(n._pattern=e.canvas.context.createPattern(n.img,n._repeat)),n.ready=!0,"no-repeat"===n._repeat&&(n.w=n.img.width,n.h=n.img.height),n.trigger("Invalidate")},this}return this.ready=!0,this.has("Canvas")&&(this._pattern=e.canvas.context.createPattern(this.img,this._repeat)),"no-repeat"===this._repeat&&(this.w=this.img.width,this.h=this.img.height),this.trigger("Invalidate"),this}}),e.extend({toRGB:function(t,e){t="#"===t.charAt(0)?t.substr(1):t;var i,n=[];return n[0]=parseInt(t.substr(0,2),16),n[1]=parseInt(t.substr(2,2),16),n[2]=parseInt(t.substr(4,2),16),i=void 0===e?"rgb("+n.join(",")+")":"rgba("+n.join(",")+","+e+")"}}),e.DrawManager=function(){function t(t,e){return t._globalZ-e._globalZ}var i=[],n=[],r=[],s=!1,o={merge:function(t,e,i){return"undefined"==typeof i&&(i={}),i._h=Math.max(t._y+t._h,e._y+e._h),i._w=Math.max(t._x+t._w,e._x+e._w),i._x=Math.min(t._x,e._x),i._y=Math.min(t._y,e._y),i._w-=i._x,i._h-=i._y,i},clean:function(){var t,e,r;for(r=0,l=n.length;l>r;r++)e=n[r],t=e._mbr||e,"undefined"==typeof e.staleRect&&(e.staleRect={}),e.staleRect._x=t._x,e.staleRect._y=t._y,e.staleRect._w=t._w,e.staleRect._h=t._h,e._changed=!1;n.length=0,i.length=0},createDirty:function(t){var e=t._mbr||t;if(t.staleRect){if(o.overlap(t.staleRect,e))return o.merge(t.staleRect,e,t.staleRect),void i.push(t.staleRect);i.push(t.staleRect)}t.currentRect._x=e._x,t.currentRect._y=e._y,t.currentRect._w=e._w,t.currentRect._h=e._h,i.push(t.currentRect)},overlap:function(t,e){return t._x<e._x+e._w&&t._y<e._y+e._h&&t._x+t._w>e._x&&t._y+t._h>e._y}};return e.bind("InvalidateViewport",function(){s=!0}),e.bind("PostRender",function(){s=!1}),{total2D:e("2D").length,onScreen:function(t){return e.viewport._x+t._x+t._w>0&&e.viewport._y+t._y+t._h>0&&e.viewport._x+t._x<e.viewport.width&&e.viewport._y+t._y<e.viewport.height},mergeSet:function(t){for(var e=0;e<t.length-1;)o.overlap(t[e],t[e+1])?(o.merge(t[e],t[e+1],t[e]),t.splice(e+1,1),e>0&&e--):e++;return t},addCanvas:function(t){n.push(t)},addDom:function(t){r.push(t)},debug:function(){console.log(n,r)},drawAll:function(i){i=i||e.viewport.rect();var n,r=e.map.search(i),s=0,o=r.length,a=e.canvas.context;for(a.clearRect(i._x,i._y,i._w,i._h),r.sort(t);o>s;s++)n=r[s],n._visible&&n.__c.Canvas&&(n.draw(),n._changed=!1)},boundingRect:function(t){if(t&&t.length){var e,i,n=1,r=t.length,s=t[0];for(s=[s._x,s._y,s._x+s._w,s._y+s._h];r>n;)e=t[n],i=[e._x,e._y,e._x+e._w,e._y+e._h],i[0]<s[0]&&(s[0]=i[0]),i[1]<s[1]&&(s[1]=i[1]),i[2]>s[2]&&(s[2]=i[2]),i[3]>s[3]&&(s[3]=i[3]),n++;return i=s,s={_x:i[0],_y:i[1],_w:i[2]-i[0],_h:i[3]-i[1]}}},renderCanvas:function(){var t=n.length;if(t||s){var i=e.canvas.context,r=e.DrawManager;if(s){var a=e.viewport;i.setTransform(a._scale,0,0,a._scale,a._x*a._scale,a._y*a._scale)}return r.drawAll(),void o.clean()}},renderDOM:function(){if(s){var t=e.stage.inner.style,i=e.viewport;t.transform=t[e.support.prefix+"Transform"]="scale("+i._scale+", "+i._scale+")",t.left=i.x*i._scale+"px",t.top=i.y*i._scale+"px",t.zIndex=10}if(r.length){for(var n=0,o=r.length;o>n;++n)r[n].draw()._changed=!1;r.length=0}}}}(),e.extend({pixelart:function(t){var i=e.canvas.context;i&&(i.imageSmoothingEnabled=!t,i.mozImageSmoothingEnabled=!t,i.webkitImageSmoothingEnabled=!t,i.oImageSmoothingEnabled=!t,i.msImageSmoothingEnabled=!t);var n=e.stage.inner.style;t?(n[e.DOM.camelize("image-rendering")]="optimizeSpeed",n[e.DOM.camelize("image-rendering")]="-moz-crisp-edges",n[e.DOM.camelize("image-rendering")]="-o-crisp-edges",n[e.DOM.camelize("image-rendering")]="-webkit-optimize-contrast",n[e.DOM.camelize("-ms-interpolation-mode")]="nearest-neighbor",n[e.DOM.camelize("image-rendering")]="optimize-contrast",n[e.DOM.camelize("image-rendering")]="pixelated",n[e.DOM.camelize("image-rendering")]="crisp-edges"):(n[e.DOM.camelize("image-rendering")]="optimizeQuality",n[e.DOM.camelize("-ms-interpolation-mode")]="bicubic",n[e.DOM.camelize("image-rendering")]="auto")}})},{"./core.js":9}],13:[function(t){var e=t("./core.js"),i=window.document;!function(){var t=e.support={},n=navigator.userAgent.toLowerCase(),r=/(webkit)[ \/]([\w.]+)/.exec(n)||/(o)pera(?:.*version)?[ \/]([\w.]+)/.exec(n)||/(ms)ie ([\w.]+)/.exec(n)||/(moz)illa(?:.*? rv:([\w.]+))?/.exec(n)||[],s=/iPad|iPod|iPhone|Android|webOS|IEMobile/i.exec(n);if(s&&(e.mobile=s[0]),t.setter="__defineSetter__"in this&&"__defineGetter__"in this,t.defineProperty=function(){if(!("defineProperty"in Object))return!1;try{Object.defineProperty({},"x",{})}catch(t){return!1}return!0}(),t.audio="Audio"in window,t.prefix=r[1]||r[0],"moz"===t.prefix&&(t.prefix="Moz"),"o"===t.prefix&&(t.prefix="O"),r[2]&&(t.versionName=r[2],t.version=+r[2].split(".")[0]),t.canvas="getContext"in i.createElement("canvas"),t.canvas){var o;try{o=i.createElement("canvas").getContext("experimental-webgl"),o.viewportWidth=t.canvas.width,o.viewportHeight=t.canvas.height}catch(a){}t.webgl=!!o}else t.webgl=!1;t.css3dtransform="undefined"!=typeof i.createElement("div").style.Perspective||"undefined"!=typeof i.createElement("div").style[t.prefix+"Perspective"],t.deviceorientation="undefined"!=typeof window.DeviceOrientationEvent||"undefined"!=typeof window.OrientationEvent,t.devicemotion="undefined"!=typeof window.DeviceMotionEvent}(),e.extend({_events:{},addEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=function(e){e=e||window.event,"function"==typeof n&&n.call(t,e)},s=t[0]||"";this._events[s+e+i+n]||(this._events[s+e+i+n]=r,e.attachEvent?e.attachEvent("on"+i,r):e.addEventListener(i,r,!1))},removeEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",s=this._events[r+e+i+n];s&&(e.detachEvent?e.detachEvent("on"+i,s):e.removeEventListener(i,s,!1),delete this._events[r+e+i+n])},background:function(t){e.stage.elem.style.background=t}})},{"./core.js":9}],14:[function(t){{var e=t("./core.js");window.document}e.c("HTML",{inner:"",init:function(){this.requires("2D, DOM")},replace:function(t){return this.inner=t,this._element.innerHTML=t,this},append:function(t){return this.inner+=t,this._element.innerHTML+=t,this},prepend:function(t){return this.inner=t+this.inner,this._element.innerHTML=t+this.inner,this}})},{"./core.js":9}],15:[function(t){var e=t("./core.js"),i=window.document;e["import"]=function(t,n){if("string"!=typeof t){var r,s,o,a,h=0;if(t.n&&"object"==typeof t.n)for(s=t.n.length;s>h;++h)o=t.n[h],a=e.e(o.c),delete o.c,a.attr(o);for(r in t)a=e(r),a.attr(t[r])}else if(levelData)e.import(n?levelData[n]:levelData);else{var l;l=i.createElement("script"),l.onload=function(){e.import(n?levelData[n]:levelData)},l.src=t}}},{"./core.js":9}],16:[function(t){{var e=t("./core.js");window.document}e.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(t,e){return this._tile.width=t,this._tile.height=e>0?e:t/2,this},place:function(t,i,n,r){var s=this.pos2px(t,i);return s.top-=n*(this._tile.height/2),r.attr({x:s.left+e.viewport._x,y:s.top+e.viewport._y}).z+=n,this},pos2px:function(t,e){return{left:t*this._tile.width+(1&e)*(this._tile.width/2),top:e*this._tile.height/2}},px2pos:function(t,e){return{x:-Math.ceil(-t/this._tile.width-.5*(1&e)),y:e/this._tile.height*2}},centerAt:function(t,i){if("number"==typeof t&&"number"==typeof i){var n=this.pos2px(t,i);return e.viewport._x=-n.left+e.viewport.width/2-this._tile.width/2,e.viewport._y=-n.top+e.viewport.height/2-this._tile.height/2,this}return{top:-e.viewport._y+e.viewport.height/2-this._tile.height/2,left:-e.viewport._x+e.viewport.width/2-this._tile.width/2}},area:function(){var t=this.centerAt(),i=this.px2pos(-t.left+e.viewport.width/2,-t.top+e.viewport.height/2),n=this.px2pos(-t.left-e.viewport.width/2,-t.top-e.viewport.height/2);return{x:{start:i.x,end:n.x},y:{start:i.y,end:n.y}}}}})},{"./core.js":9}],17:[function(t){{var e=t("./core.js");window.document}e.extend({keys:{BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,PULT_UP:29460,PULT_DOWN:29461,PULT_LEFT:4,PULT_RIGHT:5},mouseButtons:{LEFT:0,MIDDLE:1,RIGHT:2}})},{"./core.js":9}],18:[function(t){var e=t("./core.js"),i=window.document;e.extend({assets:{},asset:function(t,i){return 1===arguments.length?e.assets[t]:e.assets[t]?void 0:(e.assets[t]=i,this.trigger("NewAsset",{key:t,value:i}),i)},image_whitelist:["jpg","jpeg","gif","png","svg"],load:function(t,i,n,r){function s(){var t=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",s,!1),++f,n&&n({loaded:f,total:c,percent:f/c*100,src:t}),f===c&&i&&i()}function o(){var t=this.src;r&&r({loaded:f,total:c,percent:f/c*100,src:t}),f++,f===c&&i&&i()}for(var a,h,l=0,u=t.length,c=u,f=0,A="";u>l;++l){if(a=t[l],A=a.substr(a.lastIndexOf(".")+1,3).toLowerCase(),h=e.asset(a)||null,e.audio.supports(A)){if(!h){var d=a.substr(a.lastIndexOf("/")+1).toLowerCase();h=e.audio.create(d,a).obj}h.addEventListener&&h.addEventListener("canplaythrough",s,!1)}else{if(!(e.image_whitelist.indexOf(A)>=0)){c--;continue}h||(h=new Image,e.asset(a,h)),h.onload=s,"webkit"===e.support.prefix&&(h.src=""),h.src=a}h.onerror=o}0===c&&i()},modules:function(t,e,n){2===arguments.length&&"object"==typeof t&&(n=e,e=t,t="http://cdn.craftycomponents.com");var r=function(){function t(t,e,i){for(i=0,j=t.length;j>i;++i)if(!e(t[i]))return g;return 1}function e(e,i){t(e,function(t){return!i(t)})}function n(i,o,a){function h(t){return t.call?t():c[t]}function u(){if(!--x){c[_]=1,p&&p();for(var i in A)t(i.split("|"),h)&&!e(A[i],h)&&(A[i]=[])}}i=i[m]?i:[i];var g=o&&o.call,p=g?o:a,_=g?i.join(""):o,x=i.length;return setTimeout(function(){e(i,function(t){return d[t]?(_&&(f[_]=1),2==d[t]&&u()):(d[t]=1,_&&(f[_]=1),void r(!l.test(t)&&s?s+t+".js":t,u))})},0),n}function r(t,e){var i=a.createElement("script"),n=g;i.onload=i.onerror=i[y]=function(){i[_]&&!/^c|loade/.test(i[_])||n||(i.onload=i[y]=null,n=1,d[t]=2,e())},i.async=1,i.src=t,h.insertBefore(i,h.firstChild)}var s,o=this,a=i,h=a.getElementsByTagName("head")[0],l=/^https?:\/\//,u=o.$script,c={},f={},A={},d={},g=!1,m="push",p="DOMContentLoaded",_="readyState",x="addEventListener",y="onreadystatechange";return!a[_]&&a[x]&&(a[x](p,function v(){a.removeEventListener(p,v,g),a[_]="complete"},g),a[_]="loading"),n.get=r,n.order=function(t,e,i){!function r(s){s=t.shift(),t.length?n(s,r):n(s,e,i)}()},n.path=function(t){s=t},n.ready=function(i,r,s){i=i[m]?i:[i];var o=[];return!e(i,function(t){c[t]||o[m](t)})&&t(i,function(t){return c[t]})?r():!function(t){A[t]=A[t]||[],A[t][m](r),s&&s(o)}(i.join("|")),n},n.noConflict=function(){return o.$script=u,this},n}(),s=[],o=/^(https?|file):\/\//;for(var a in e)s.push(o.test(a)?a:t+"/"+a.toLowerCase()+"-"+e[a].toLowerCase()+".js");r(s,function(){n&&n()})}})},{"./core.js":9}],19:[function(t){{var e=t("./core.js");window.document}e.math={abs:function(t){return 0>t?-t:t},amountOf:function(t,e,i){return i>e?(t-e)/(i-e):(t-i)/(e-i)},clamp:function(t,e,i){return t>i?i:e>t?e:t},degToRad:function(t){return t*Math.PI/180},distance:function(t,i,n,r){var s=e.math.squaredDistance(t,i,n,r);return Math.sqrt(parseFloat(s))},lerp:function(t,e,i){return t+(e-t)*i},negate:function(t){return Math.random()<t?-1:1},radToDeg:function(t){return 180*t/Math.PI},randomElementOfArray:function(t){return t[Math.floor(t.length*Math.random())]},randomInt:function(t,e){return t+Math.floor((1+e-t)*Math.random())},randomNumber:function(t,e){return t+(e-t)*Math.random()},squaredDistance:function(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)},withinRange:function(t,e,i){return t>=e&&i>=t}},e.math.Vector2D=function(){function t(e,i){if(e instanceof t)this.x=e.x,this.y=e.y;else if(2===arguments.length)this.x=e,this.y=i;else if(arguments.length>0)throw"Unexpected number of arguments for Vector2D()"}return t.prototype.x=0,t.prototype.y=0,t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.angleBetween=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},t.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},t.prototype.clone=function(){return new t(this)},t.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},t.prototype.distanceSq=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.equals=function(e){return e instanceof t&&this.x==e.x&&this.y==e.y},t.prototype.getNormal=function(e){return void 0===e?new t(-this.y,this.x):new t(e.y-this.y,this.x-e.x).normalize()},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.magnitudeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return 0===t?(this.x=1,this.y=0):(this.x/=t,this.y/=t),this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.scaleToMagnitude=function(t){var e=t/this.magnitude();return this.x*=e,this.y*=e,this},t.prototype.setValues=function(e,i){return e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.toString=function(){return"Vector2D("+this.x+", "+this.y+")"
},t.prototype.translate=function(t,e){return void 0===e&&(e=t),this.x+=t,this.y+=e,this},t.tripleProduct=function(t,i,n){var r=t.dotProduct(n),s=i.dotProduct(n);return new e.math.Vector2D(i.x*r-t.x*s,i.y*r-t.y*s)},t}(),e.math.Matrix2D=function(){return Matrix2D=function(t,e,i,n,r,s){if(t instanceof Matrix2D)this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.e=t.e,this.f=t.f;else if(6===arguments.length)this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=s;else if(arguments.length>0)throw"Unexpected number of arguments for Matrix2D()"},Matrix2D.prototype.a=1,Matrix2D.prototype.b=0,Matrix2D.prototype.c=0,Matrix2D.prototype.d=1,Matrix2D.prototype.e=0,Matrix2D.prototype.f=0,Matrix2D.prototype.apply=function(t){var e=t.x;return t.x=e*this.a+t.y*this.c+this.e,t.y=e*this.b+t.y*this.d+this.f,t},Matrix2D.prototype.clone=function(){return new Matrix2D(this)},Matrix2D.prototype.combine=function(t){var e=this.a;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,e=this.c,this.c=e*t.a+this.d*t.c,this.d=e*t.b+this.d*t.d,e=this.e,this.e=e*t.a+this.f*t.c+t.e,this.f=e*t.b+this.f*t.d+t.f,this},Matrix2D.prototype.equals=function(t){return t instanceof Matrix2D&&this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.e==t.e&&this.f==t.f},Matrix2D.prototype.determinant=function(){return this.a*this.d-this.b*this.c},Matrix2D.prototype.invert=function(){var t=this.determinant();if(0!==t){var e={a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f};this.a=e.d/t,this.b=-e.b/t,this.c=-e.c/t,this.d=e.a/t,this.e=(e.c*e.f-e.e*e.d)/t,this.f=(e.e*e.b-e.a*e.f)/t}return this},Matrix2D.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},Matrix2D.prototype.isInvertible=function(){return 0!==this.determinant()},Matrix2D.prototype.preRotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,this},Matrix2D.prototype.preScale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this},Matrix2D.prototype.preTranslate=function(t,e){return"number"==typeof t?(this.e+=t,this.f+=e):(this.e+=t.x,this.f+=t.y),this},Matrix2D.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,n=this.e,this.e=e*n-i*this.f,this.f=i*n+e*this.f,this},Matrix2D.prototype.scale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this},Matrix2D.prototype.setValues=function(t,e,i,n,r,s){return t instanceof Matrix2D?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.e=t.e,this.f=t.f):(this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=s),this},Matrix2D.prototype.toString=function(){return"Matrix2D(["+this.a+", "+this.c+", "+this.e+"] ["+this.b+", "+this.d+", "+this.f+"] [0, 0, 1])"},Matrix2D.prototype.translate=function(t,e){return"number"==typeof t?(this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e):(this.e+=this.a*t.x+this.c*t.y,this.f+=this.b*t.x+this.d*t.y),this},Matrix2D}()},{"./core.js":9}],20:[function(t){var e=t("./core.js"),i=window.document;e.c("Particles",{init:function(){this._Particles=e.clone(this._Particles),this._Particles.parentEntity=this},particles:function(t){if(!e.support.canvas||e.deactivateParticles)return this;var n,r,s,o,a;n=i.createElement("canvas"),n.width=e.viewport.width,n.height=e.viewport.height,n.style.position="absolute",n.style.left="0px",n.style.top="0px",e.stage.elem.appendChild(n),r=n.getContext("2d"),this._Particles.init(t),this.bind("Remove",function(){e.stage.elem.removeChild(n)}).bind("RemoveComponent",function(t){"particles"===t&&e.stage.elem.removeChild(n)}),s=this.x+e.viewport.x,o=this.y+e.viewport.y,this._Particles.position=this._Particles.vectorHelpers.create(s,o);var h={x:e.viewport.x,y:e.viewport.y};return this.bind("EnterFrame",function(){s=this.x+e.viewport.x,o=this.y+e.viewport.y,this._Particles.viewportDelta={x:e.viewport.x-h.x,y:e.viewport.y-h.y},h={x:e.viewport.x,y:e.viewport.y},this._Particles.position=this._Particles.vectorHelpers.create(s,o),"function"==typeof e.DrawManager.boundingRect?(a=e.DrawManager.boundingRect(this._Particles.register),a&&r.clearRect(a._x,a._y,a._w,a._h)):r.clearRect(0,0,e.viewport.width,e.viewport.height),this._Particles.update(),this._Particles.render(r)}),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,particles:[],active:!0,particleCount:0,elapsedFrames:0,emissionRate:0,emitCounter:0,particleIndex:0},init:function(t){this.position=this.vectorHelpers.create(0,0),"undefined"==typeof t&&(t={});for(var e in this.presets)this[e]="undefined"!=typeof t[e]?t[e]:this.presets[e];this.emissionRate=this.maxParticles/this.lifeSpan,this.positionRandom=this.vectorHelpers.create(this.spread,this.spread)},addParticle:function(){if(this.particleCount==this.maxParticles)return!1;var t=new this.particle(this.vectorHelpers);return this.initParticle(t),this.particles[this.particleCount]=t,this.particleCount++,!0},RANDM1TO1:function(){return 2*Math.random()-1},initParticle:function(t){t.position.x=this.position.x+this.positionRandom.x*this.RANDM1TO1(),t.position.y=this.position.y+this.positionRandom.y*this.RANDM1TO1();var e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),i=this.vectorHelpers.create(Math.sin(e),-Math.cos(e)),n=this.speed+this.speedRandom*this.RANDM1TO1();t.direction=this.vectorHelpers.multiply(i,n),t.size=this.size+this.sizeRandom*this.RANDM1TO1(),t.size=t.size<0?0:~~t.size,t.timeToLive=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),t.sharpness=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),t.sharpness=t.sharpness>100?100:t.sharpness<0?0:t.sharpness,t.sizeSmall=~~(t.size/200*t.sharpness);var r=[this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1()],s=[this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1()];t.colour=r,t.deltaColour[0]=(s[0]-r[0])/t.timeToLive,t.deltaColour[1]=(s[1]-r[1])/t.timeToLive,t.deltaColour[2]=(s[2]-r[2])/t.timeToLive,t.deltaColour[3]=(s[3]-r[3])/t.timeToLive},update:function(){if(this.active&&this.emissionRate>0){var t=1/this.emissionRate;for(this.emitCounter++;this.particleCount<this.maxParticles&&this.emitCounter>t;)this.addParticle(),this.emitCounter-=t;this.elapsedFrames++,-1!=this.duration&&this.duration<this.elapsedFrames&&this.stop()}this.particleIndex=0,this.register=[];for(var e;this.particleIndex<this.particleCount;){var i=this.particles[this.particleIndex];if(i.timeToLive>0){i.direction=this.vectorHelpers.add(i.direction,this.gravity),i.position=this.vectorHelpers.add(i.position,i.direction),i.position=this.vectorHelpers.add(i.position,this.viewportDelta),this.jitter&&(i.position.x+=this.jitter*this.RANDM1TO1(),i.position.y+=this.jitter*this.RANDM1TO1()),i.timeToLive--;var n=i.colour[0]+=i.deltaColour[0],r=i.colour[1]+=i.deltaColour[1],s=i.colour[2]+=i.deltaColour[2],o=i.colour[3]+=i.deltaColour[3];e=[],e.push("rgba("+(n>255?255:0>n?0:~~n)),e.push(r>255?255:0>r?0:~~r),e.push(s>255?255:0>s?0:~~s),e.push((o>1?1:0>o?0:o.toFixed(2))+")"),i.drawColour=e.join(","),this.fastMode||(e[3]="0)",i.drawColourEnd=e.join(",")),this.particleIndex++}else this.particleIndex!=this.particleCount-1&&(this.particles[this.particleIndex]=this.particles[this.particleCount-1]),this.particleCount--;var a={};a._x=~~i.position.x,a._y=~~i.position.y,a._w=i.size,a._h=i.size,this.register.push(a)}},stop:function(){this.active=!1,this.elapsedFrames=0,this.emitCounter=0,this.parentEntity.trigger("ParticleEnd")},render:function(t){for(var i=0,n=this.particleCount;n>i;i++){var r=this.particles[i],s=r.size,o=s>>1;if(!(r.position.x+s<0||r.position.y+s<0||r.position.x-s>e.viewport.width||r.position.y-s>e.viewport.height)){var a=~~r.position.x,h=~~r.position.y;if(this.fastMode)t.fillStyle=r.drawColour;else{var l=t.createRadialGradient(a+o,h+o,r.sizeSmall,a+o,h+o,o);l.addColorStop(0,r.drawColour),l.addColorStop(.9,r.drawColourEnd),t.fillStyle=l}t.fillRect(a,h,s,s)}}},particle:function(t){this.position=t.create(0,0),this.direction=t.create(0,0),this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colour=[],this.drawColour="",this.deltaColour=[],this.sharpness=0},vectorHelpers:{create:function(t,e){return{x:t,y:e}},multiply:function(t,e){return t.x*=e,t.y*=e,t},add:function(t,e){return t.x+=e.x,t.y+=e.y,t}}}})},{"./core.js":9}],21:[function(t){{var e=t("./core.js");window.document}e.extend({_scenes:{},_current:null,scene:function(t,i,n){return 1===arguments.length||"function"!=typeof arguments[1]?void e.enterScene(t,arguments[1]):void e.defineScene(t,i,n)},defineScene:function(t,e,i){if("function"!=typeof e)throw"Init function is the wrong type.";this._scenes[t]={},this._scenes[t].initialize=e,"undefined"!=typeof i&&(this._scenes[t].uninitialize=i)},enterScene:function(t,i){if("function"==typeof i)throw"Scene data cannot be a function";e.trigger("SceneDestroy",{newScene:t}),e.viewport.reset(),e("2D").each(function(){this.has("Persist")||this.destroy()}),null!==this._current&&"uninitialize"in this._scenes[this._current]&&this._scenes[this._current].uninitialize.call(this);var n=this._current;this._current=t,e.trigger("SceneChange",{oldScene:n,newScene:t}),this._scenes[t].initialize.call(this,i)}})},{"./core.js":9}],22:[function(t){var e=t("./core.js"),i=window.document;e.extend({audio:{sounds:{},supported:null,codecs:{ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',webma:'audio/webm; codecs="vorbis"',mp3:'audio/mpeg; codecs="mp3"',m4a:'audio/mp4; codecs="mp4a.40.2"'},volume:1,muted:!1,paused:!1,playCheck:null,_canPlay:function(){if(this.supported={},e.support.audio){var t,i=this.audioElement();for(var n in this.codecs)t=i.canPlayType(this.codecs[n]),this.supported[n]=""!==t&&"no"!==t?!0:!1}},supports:function(t){return null===this.supported&&this._canPlay(),this.supported[t]?!0:!1},audioElement:function(){return"undefined"!=typeof Audio?new Audio(""):i.createElement("audio")},create:function(t,i){var n=i.substr(i.lastIndexOf(".")+1).toLowerCase();if(!this.supports(n))return!1;var r=this.audioElement();return r.id=t,r.preload="auto",r.volume=e.audio.volume,r.src=i,e.asset(i,r),this.sounds[t]={obj:r,played:0,volume:e.audio.volume},this.sounds[t]},add:function(t,i){if(e.support.audio){var n;if(1===arguments.length&&"object"==typeof t)for(var r in t)for(n in t[r])if(e.audio.create(r,t[r][n]))break;if("string"==typeof t&&("string"==typeof i&&e.audio.create(t,i),"object"==typeof i))for(n in i)if(e.audio.create(t,i[n]))break}},play:function(t,i,n){if(0!==i&&e.support.audio&&this.sounds[t]){var r=this.sounds[t],s=this.getOpenChannel();if(!s)return null;s.id=t,s.repeat=i;var o=s.obj;return s.volume=r.volume=r.obj.volume=n||e.audio.volume,o.volume=r.volume,o.src=r.obj.src,this.muted&&(o.volume=0),o.play(),r.played++,s.onEnd=function(){r.played<s.repeat||-1==i?(this.currentTime&&(this.currentTime=0),this.play(),r.played++):(s.active=!1,this.pause(),this.removeEventListener("ended",s.onEnd,!0),this.currentTime=0,e.trigger("SoundComplete",{id:s.id}))},o.addEventListener("ended",s.onEnd,!0),o}},maxChannels:7,setChannels:function(t){this.maxChannels=t,t<this.channels.length&&(this.channels.length=t)},channels:[],getOpenChannel:function(){for(var t=0;t<this.channels.length;t++){var e=this.channels[t];if(e.active===!1||e.obj.ended&&e.repeat<=this.sounds[e.id].played)return e.active=!0,e}if(t<this.maxChannels){var i={obj:this.audioElement(),active:!0,_is:function(t){return this.id===t&&this.active}};return this.channels.push(i),i}return null},remove:function(t){if(e.support.audio){var i;if(t)this.sounds[t]&&(i=this.sounds[t],e.audio.stop(t),delete e.assets[i.obj.src],delete e.audio.sounds[t]);else for(var n in this.sounds)i=this.sounds[n],e.audio.stop(t),delete e.assets[i.obj.src],delete e.audio.sounds[t]}},stop:function(t){if(e.support.audio)for(var i in this.channels)c=this.channels[i],(!t&&c.active||c._is(t))&&(c.active=!1,c.obj.pause())},_mute:function(t){if(e.support.audio){var i;for(var n in this.channels)i=this.channels[n],i.obj.volume=t?0:i.volume;this.muted=t}},toggleMute:function(){this._mute(this.muted?!1:!0)},mute:function(){this._mute(!0)},unmute:function(){this._mute(!1)},pause:function(t){if(e.support.audio&&t&&this.sounds[t]){var i;for(var n in this.channels)i=this.channels[n],i._is(t)&&!i.obj.paused&&i.obj.pause()}},unpause:function(t){if(e.support.audio&&t&&this.sounds[t]){var i;for(var n in this.channels)i=this.channels[n],i._is(t)&&i.obj.paused&&i.obj.play()}},togglePause:function(t){if(e.support.audio&&t&&this.sounds[t]){var i;for(var n in this.channels)i=this.channels[n],i._is(t)&&(i.obj.paused?i.obj.play():i.obj.pause())}}}})},{"./core.js":9}],23:[function(t){{var e=t("./core.js");t("./animation.js"),window.document}e.c("SpriteAnimation",{_reels:null,_currentReelId:null,_currentReel:null,_isPlaying:!1,animationSpeed:1,init:function(){this._reels={}},reel:function(t,i,n,r,s){if(0===arguments.length)return this._currentReelId;if(1===arguments.length&&"string"==typeof t){if("undefined"==typeof this._reels[t])throw"The specified reel "+t+" is undefined.";return this.pauseAnimation(),this._currentReelId!==t&&(this._currentReelId=t,this._currentReel=this._reels[t],this._updateSprite(),this.trigger("ReelChange",this._currentReel)),this}var o,a;if(o={id:t,frames:[],currentFrame:0,easing:new e.easing(i),defaultLoops:1},o.duration=o.easing.duration,"number"==typeof n)if(a=n,y=r,s>=0)for(;n+s>a;a++)o.frames.push([a,y]);else for(;a>n+s;a--)o.frames.push([a,y]);else{if(3!==arguments.length||"object"!=typeof n)throw"Urecognized arguments. Please see the documentation for 'reel(...)'.";o.frames=n}return this._reels[t]=o,this},animate:function(t,e){"string"==typeof t&&this.reel(t);var i=this._currentReel;if("undefined"==typeof i||null===i)throw"No reel is specified, and there is no currently active reel.";return this.pauseAnimation(),"undefined"==typeof e&&(e="number"==typeof t?t:1),i.easing.reset(),this.loops(e),this._setFrame(0),this.bind("EnterFrame",this._animationTick),this._isPlaying=!0,this.trigger("StartAnimation",i),this},resumeAnimation:function(){return this._isPlaying===!1&&null!==this._currentReel&&(this.bind("EnterFrame",this._animationTick),this._isPlaying=!0,this._currentReel.easing.resume(),this.trigger("StartAnimation",this._currentReel)),this},pauseAnimation:function(){return this._isPlaying===!0&&(this.unbind("EnterFrame",this._animationTick),this._isPlaying=!1,this._reels[this._currentReelId].easing.pause()),this},resetAnimation:function(){var t=this._currentReel;if(null===t)throw"No active reel to reset.";return this.reelPosition(0),t.easing.repeat(t.defaultLoops),this},loops:function(t){return 0===arguments.length?null!==this._currentReel?this._currentReel.easing.loops:0:(null!==this._currentReel&&(0>t&&(t=1/0),this._currentReel.easing.repeat(t),this._currentReel.defaultLoops=t),this)},reelPosition:function(t){if(null===this._currentReel)throw"No active reel.";if(0===arguments.length)return this._currentReel.currentFrame;var e,i=this._currentReel.frames.length;if("end"===t&&(t=i-1),1>t&&t>0)e=t,t=Math.floor(i*e);else{if(t!==Math.floor(t))throw"Position "+t+" is invalid.";0>t&&(t=i-1+t),e=t/i}return t=Math.min(t,i-1),t=Math.max(t,0),this._setProgress(e),this._setFrame(t),this},_animationTick:function(t){var e=this._reels[this._currentReelId];e.easing.tick(t.dt*this.animationSpeed);var i=e.easing.value(),n=Math.min(Math.floor(e.frames.length*i),e.frames.length-1);this._setFrame(n),e.easing.complete===!0&&(this.trigger("AnimationEnd",this._currentReel),this.pauseAnimation())},_setFrame:function(t){var e=this._currentReel;t!==e.currentFrame&&(e.currentFrame=t,this._updateSprite(),this.trigger("FrameChange",e))},_updateSprite:function(){var t=this._currentReel,e=t.frames[t.currentFrame];this.sprite(e[0],e[1])},_setProgress:function(t,e){this._currentReel.easing.setProgress(t,e)},isPlaying:function(t){return this._isPlaying?t?this._currentReelId===t:!!this._currentReelId:!1},getReel:function(t){if(0===arguments.length){if(!this._currentReelId)return null;t=this._currentReelId}return this._reels[t]}})},{"./animation.js":5,"./core.js":9}],24:[function(t){{var e=t("./core.js");window.document}e.extend({sprite:function(t,i,n,r,s,o,a){var h,l,u;"string"==typeof t&&(o=s,s=r,r=i,n=t,t=1,i=1),"string"==typeof i&&(o=s,s=r,r=n,n=i,i=t),!o&&s&&(o=s),s=parseInt(s||0,10),o=parseInt(o||0,10);var c=function(){this.ready=!0,this.trigger("Invalidate")};u=e.asset(n),u||(u=new Image,u.src=n,e.asset(n,u),u.onload=function(){for(var t in r)e(t).each(c)});var f=function(){this.requires("2D, Sprite"),this.__trim=[0,0,0,0],this.__image=n,this.__coord=[this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]],this.__tile=t,this.__tileh=i,this.__padding=[s,o],this.__padBorder=a,this.sprite(this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]),this.img=u,this.img.complete&&this.img.width>0&&(this.ready=!0,this.trigger("Invalidate")),this.w=this.__coord[2],this.h=this.__coord[3]};for(h in r)r.hasOwnProperty(h)&&(l=r[h],e.c(h,{ready:!1,__coord:[l[0],l[1],l[2]||1,l[3]||1],init:f}));return this}}),e.c("Sprite",{__image:"",__tile:0,__tileh:0,__padding:null,__trim:null,img:null,ready:!1,init:function(){this.__trim=[0,0,0,0];var t=function(t){var e=t.co,i=t.pos,n=t.ctx;if("canvas"===t.type)n.drawImage(this.img,e.x,e.y,e.w,e.h,i._x,i._y,i._w,i._h);else if("DOM"===t.type){var r=this._h/e.h,s=this._w/e.w,o=this._element.style;o.background=o.backgroundColor+" url('"+this.__image+"') no-repeat",o.backgroundPosition="-"+e.x*s+"px -"+e.y*r+"px",(1!=r||1!=s)&&(o.backgroundSize=this.img.width*s+"px "+this.img.height*r+"px")}};this.bind("Draw",t).bind("RemoveComponent",function(e){"Sprite"===e&&this.unbind("Draw",t)})},sprite:function(t,e,i,n){return this.__coord=this.__coord||[0,0,0,0],this.__coord[0]=t*(this.__tile+this.__padding[0])+(this.__padBorder?this.__padding[0]:0)+this.__trim[0],this.__coord[1]=e*(this.__tileh+this.__padding[1])+(this.__padBorder?this.__padding[1]:0)+this.__trim[1],"undefined"!=typeof i&&"undefined"!=typeof n&&(this.__coord[2]=this.__trim[2]||i*this.__tile||this.__tile,this.__coord[3]=this.__trim[3]||n*this.__tileh||this.__tileh),this.trigger("Invalidate"),this},crop:function(t,e,i,n){var r=this._mbr||this.pos();return this.__trim=[],this.__trim[0]=t,this.__trim[1]=e,this.__trim[2]=i,this.__trim[3]=n,this.__coord[0]+=t,this.__coord[1]+=e,this.__coord[2]=i,this.__coord[3]=n,this._w=i,this._h=n,this.trigger("Invalidate",r),this}})},{"./core.js":9}],25:[function(t){{var e=t("./core.js");window.document}e.storage=function(t,e){var i=window.localStorage,n=e;if(!i)return!1;if(1===arguments.length)try{return JSON.parse(i.getItem(t))}catch(r){return i.getItem(t)}else"object"==typeof e&&(n=JSON.stringify(e)),i.setItem(t,n)},e.storage.remove=function(t){window.localStorage.removeItem(t)}},{"./core.js":9}],26:[function(t){{var e=t("./core.js");window.document}e.c("Text",{_text:"",defaultSize:"10px",defaultFamily:"sans-serif",defaultVariant:"normal",defaultLineHeight:"normal",ready:!0,init:function(){this.requires("2D"),this._textFont={type:"",weight:"",size:this.defaultSize,lineHeight:this.defaultLineHeight,family:this.defaultFamily,variant:this.defaultVariant},this.bind("Draw",function(t){var e=this._fontString();if("DOM"===t.type){var i=this._element,n=i.style;n.color=this._textColor,n.font=e,i.innerHTML=this._text}else if("canvas"===t.type){var r=t.ctx;r.save(),r.textBaseline="top",r.fillStyle=this._textColor||"rgb(0,0,0)",r.font=e,r.fillText(this._text,this._x,this._y),r.restore()}})},_getFontHeight:function(){var t=/([a-zA-Z]+)\b/,e={px:1,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,"in":96,em:void 0,ex:void 0};return function(i){var n=parseFloat(i),r=t.exec(i),s=r?r[1]:"px";return Math.ceil(void 0!==e[s]?n*e[s]:n)}}(),text:function(t){return"undefined"==typeof t||null===t?this._text:(this._text="function"==typeof t?t.call(this):t,this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this)},_resizeForCanvas:function(){var t=e.canvas.context;t.font=this._fontString(),this.w=t.measureText(this._text).width;var i=this._textFont.size||this.defaultSize;this.h=1.1*this._getFontHeight(i)},_fontString:function(){return this._textFont.type+" "+this._textFont.variant+" "+this._textFont.weight+" "+this._textFont.size+" / "+this._textFont.lineHeight+" "+this._textFont.family},textColor:function(t,i){return this._strength=i,this._textColor=e.toRGB(t,this._strength),this.trigger("Invalidate"),this},textFont:function(t,e){if(1===arguments.length){if("string"==typeof t)return this._textFont[t];if("object"==typeof t)for(var i in t)this._textFont[i]="family"==i?"'"+t[i]+"'":t[i]}else this._textFont[t]=e;return this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},unselectable:function(){return this.has("DOM")&&(this.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}),this.trigger("Invalidate")),this}})},{"./core.js":9}],27:[function(t){{var e=t("./core.js");window.document}e.c("Delay",{init:function(){this._delays=[],this.bind("EnterFrame",function(){for(var t=(new Date).getTime(),e=this._delays.length;--e>=0;){var i=this._delays[e];i.start+i.delay+i.pause<t&&(i.func.call(this),i.repeat>0?(i.start=t,i.pause=0,i.pauseBuffer=0,i.repeat--):i.repeat<=0&&this._delays.splice(e,1))}}),this.bind("Pause",function(){var t=(new Date).getTime();for(var e in this._delays)this._delays[e].pauseBuffer=t}),this.bind("Unpause",function(){var t=(new Date).getTime();for(var e in this._delays){var i=this._delays[e];i.pause+=t-i.pauseBuffer}})},delay:function(t,e,i){return this._delays.push({start:(new Date).getTime(),func:t,delay:e,repeat:(0>i?1/0:i)||0,pauseBuffer:0,pause:0}),this}})},{"./core.js":9}],28:[function(t,e){e.exports="0.6.2"},{}],29:[function(t){var e=t("./core.js"),i=window.document;e.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,i){this[t]=i,e.trigger("ViewportScroll"),e.trigger("InvalidateViewport")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(){return this.rect_object._x=-this._x,this.rect_object._y=-this._y,this.rect_object._w=this._width/this._scale,this.rect_object._h=this._height/this._scale,this.rect_object},pan:function(){function t(t){a.tick(t.dt);var h=a.value();e.viewport.x=(1-h)*s+h*n,e.viewport.y=(1-h)*o+h*r,e.viewport._clamp(),a.complete&&(i(),e.trigger("CameraAnimationDone"))}function i(){e.unbind("EnterFrame",t)}var n,r,s,o,a;return e.bind("StopCamera",i),function(i,h,l){e.trigger("StopCamera"),"reset"!=i&&(s=e.viewport._x,o=e.viewport._y,n=s-i,r=o-h,a=new e.easing(l),e.uniqueBind("EnterFrame",t))}}(),follow:function(){function t(){e.viewport.scroll("_x",-(this.x+this.w/2-e.viewport.width/2-r)),e.viewport.scroll("_y",-(this.y+this.h/2-e.viewport.height/2-s)),e.viewport._clamp()}function i(){n&&n.unbind("Move",t)}var n,r,s;return e.bind("StopCamera",i),function(i,o,a){i&&i.has("2D")&&(e.trigger("StopCamera"),n=i,r="undefined"!=typeof o?o:0,s="undefined"!=typeof a?a:0,i.bind("Move",t),t.call(i))}}(),centerOn:function(t,i){var n=t.x+e.viewport.x,r=t.y+e.viewport.y,s=t.w/2,o=t.h/2,a=e.viewport.width/2,h=e.viewport.height/2,l=n+s-a,u=r+o-h;e.viewport.pan(l,u,i)},zoom:function(){function t(){e.unbind("EnterFrame",i)}function i(i){var r,c;u.tick(i.dt),r=Math.pow(s,u.value()),c=1===s?u.value():(1/r-1)/(1/s-1),e.viewport.scale(r*n),e.viewport.scroll("_x",o*(1-c)+a*c),e.viewport.scroll("_y",h*(1-c)+l*c),e.viewport._clamp(),u.complete&&(t(),e.trigger("CameraAnimationDone"))}e.bind("StopCamera",t);var n,r,s,o,a,h,l,u;return function(t,c,f,A){return t?(arguments.length<=2&&(A=c,c=e.viewport.x-e.viewport.width,f=e.viewport.y-e.viewport.height),e.trigger("StopCamera"),n=e.viewport._scale,s=t,r=n*s,o=e.viewport.x,h=e.viewport.y,a=-(c-e.viewport.width/(2*r)),l=-(f-e.viewport.height/(2*r)),u=new e.easing(A),void e.uniqueBind("EnterFrame",i)):void e.viewport.scale(1)}}(),scale:function(){return function(t){this._scale=t?t:1,e.trigger("InvalidateViewport"),e.trigger("ViewportScale")}}(),mouselook:function(){var t=!1,i=!1,n={};return old={},function(r,s){if("boolean"==typeof r)return t=r,void(t?e.mouseObjs++:e.mouseObjs=Math.max(0,e.mouseObjs-1));if(t)switch(r){case"move":case"drag":if(!i)return;diff={x:s.clientX-n.x,y:s.clientY-n.y},n.x=s.clientX,n.y=s.clientY,e.viewport.x+=diff.x,e.viewport.y+=diff.y,e.viewport._clamp();break;case"start":e.trigger("StopCamera"),n.x=s.clientX,n.y=s.clientY,i=!0;break;case"stop":i=!1}}}(),_clamp:function(){if(this.clampToEntities){var t=this.bounds||e.map.boundaries();t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>e.viewport.width?e.viewport.x<-t.max.x+e.viewport.width?e.viewport.x=-t.max.x+e.viewport.width:e.viewport.x>-t.min.x&&(e.viewport.x=-t.min.x):e.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-e.viewport.width/2),t.max.y-t.min.y>e.viewport.height?e.viewport.y<-t.max.y+e.viewport.height?e.viewport.y=-t.max.y+e.viewport.height:e.viewport.y>-t.min.y&&(e.viewport.y=-t.min.y):e.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-e.viewport.height/2)}},init:function(t,n,r){e.DOM.window.init(),this._defineViewportProperties(),this._width=t?t:e.DOM.window.width,this._height=n?n:e.DOM.window.height,"undefined"==typeof r&&(r="cr-stage");var s;if("string"==typeof r)s=i.getElementById(r);else{if(!("undefined"!=typeof HTMLElement?r instanceof HTMLElement:r instanceof Element))throw new TypeError("stage_elem must be a string or an HTMLElement");s=r}e.stage={x:0,y:0,fullscreen:!1,elem:s?s:i.createElement("div"),inner:i.createElement("div")},t||n||(i.body.style.overflow="hidden",e.stage.fullscreen=!0),e.addEvent(this,window,"resize",e.viewport.reload),e.addEvent(this,window,"blur",function(){e.settings.get("autoPause")&&(e._paused||e.pause())}),e.addEvent(this,window,"focus",function(){e._paused&&e.settings.get("autoPause")&&e.pause()}),e.settings.register("stageSelectable",function(t){e.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}}),e.settings.modify("stageSelectable",!1),e.settings.register("stageContextMenu",function(t){e.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}}),e.settings.modify("stageContextMenu",!1),e.settings.register("autoPause",function(){}),e.settings.modify("autoPause",!1),s||(i.body.appendChild(e.stage.elem),e.stage.elem.id=r);var o,a=e.stage.elem.style;if(e.stage.elem.appendChild(e.stage.inner),e.stage.inner.style.position="absolute",e.stage.inner.style.zIndex="1",e.stage.inner.style.transformStyle="preserve-3d",a.width=this.width+"px",a.height=this.height+"px",a.overflow="hidden",e.bind("ViewportResize",function(){e.trigger("InvalidateViewport")}),e.mobile){void 0!==typeof a.webkitTapHighlightColor&&(a.webkitTapHighlightColor="rgba(0,0,0,0)");var h=i.createElement("meta"),l=i.getElementsByTagName("HEAD")[0];h=i.createElement("meta"),h.setAttribute("name","apple-mobile-web-app-capable"),h.setAttribute("content","yes"),l.appendChild(h),e.addEvent(this,e.stage.elem,"touchmove",function(t){t.preventDefault()})}else a.position="relative",o=e.DOM.inner(e.stage.elem),e.stage.x=o.x,e.stage.y=o.y},_defineViewportProperties:function(){e.support.setter?(this.__defineSetter__("x",function(t){this.scroll("_x",t)}),this.__defineSetter__("y",function(t){this.scroll("_y",t)}),this.__defineSetter__("width",function(t){this._width=t,e.trigger("ViewportResize")}),this.__defineSetter__("height",function(t){this._height=t,e.trigger("ViewportResize")}),this.__defineGetter__("x",function(){return this._x}),this.__defineGetter__("y",function(){return this._y}),this.__defineGetter__("width",function(){return this._width}),this.__defineGetter__("height",function(){return this._height})):e.support.defineProperty&&(Object.defineProperty(this,"x",{set:function(t){this.scroll("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this.scroll("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"width",{set:function(t){this._width=t,e.trigger("ViewportResize")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,"height",{set:function(t){this._height=t,e.trigger("ViewportResize")},get:function(){return this._height},configurable:!0}))},reload:function(){e.DOM.window.init();var t,i=e.DOM.window.width,n=e.DOM.window.height;e.stage.fullscreen&&(this._width=i,this._height=n,e.trigger("ViewportResize")),t=e.DOM.inner(e.stage.elem),e.stage.x=t.x,e.stage.y=t.y},reset:function(){e.viewport.mouselook("stop"),e.trigger("StopCamera"),e.viewport.scale(1)}}})},{"./core.js":9}],30:[function(t){var e=t("./core.js"),i=window.document,n="precision mediump float;void main(void) {gl_FragColor = vec4(0.0, 1.0, 1.0, 0.5);}",r="precision mediump float;void main(void) {gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);}";glHelpers={writeVec2:function(t,e,i,n,r){if(5==arguments.length)for(var s=0;4>s;s++)t[e+i*s]=n,t[e+i*s+1]=r;else for(var s=0;4>s;s++)t[e+i*s]=arguments[3+2*s],t[e+i*s+1]=arguments[4+2*s]},writeVec4:function(t,e,i,n,r,s,o){if(7==arguments.length)for(var a=0;4>a;a++)t[e+i*a]=n,t[e+i*a+1]=r,t[e+i*a+2]=s,t[e+i*a+3]=o;else for(var a=0;4>a;a++)t[e+i*a]=arguments[3+4*a],t[e+i*a+1]=arguments[4+4*a],t[e+i*a+2]=arguments[5+4*a],t[e+i*a+3]=arguments[6+4*a]},makeProgram:function(t,e,i){var t=this.context,n=this.compileShader(t,e,t.FRAGMENT_SHADER),r=this.compileShader(t,i,t.VERTEX_SHADER),s=t.createProgram();if(t.attachShader(s,r),t.attachShader(s,n),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw"Could not initialise shaders";return s.viewport=t.getUniformLocation(s,"uViewport"),s},compileShader:function(t,e,i){var n=t.createShader(i);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw t.getShaderInfoLog(n);return n}};var s="attribute vec2 aPosition;\r\nattribute vec4 aExtras;\r\nattribute vec4 aColor;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nuniform  vec4 uViewport;\r\n\r\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\r\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\r\n\r\nvec2 entityOrigin = aExtras.xy;\r\nmat2 entityRotationMatrix = mat2(cos(aExtras.w), sin(aExtras.w), -sin(aExtras.w), cos(aExtras.w));\r\n\r\nvoid main() {\r\n  vec2 pos = aPosition;\r\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\r\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aExtras.z) ), 1) );\r\n  vColor = aColor;\r\n}",o="attribute vec2 aPosition;\r\nattribute vec4 aExtras;\r\nattribute vec2 aTextureCoord;\r\n\r\nvarying mediump vec2 vTextureCoord;\r\n\r\nuniform vec4 uViewport;\r\nuniform mediump vec2 uTextureDimensions;\r\n\r\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\r\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\r\n\r\nvec2 entityOrigin = aExtras.xy;\r\nmat2 entityRotationMatrix = mat2(cos(aExtras.w), sin(aExtras.w), -sin(aExtras.w), cos(aExtras.w));\r\n\r\nvoid main() {\r\n  vec2 pos = aPosition;\r\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\r\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aExtras.z) ), 1) );\r\n  vTextureCoord = aTextureCoord;\r\n}\r\n",a="    varying mediump vec2 vTextureCoord;\r\n      \r\n    uniform sampler2D uSampler;\r\n    uniform mediump vec2 uTextureDimensions;\r\n\r\n    void main(void) {\r\n      highp vec2 coord =   vTextureCoord / uTextureDimensions;\r\n      gl_FragColor = texture2D(uSampler, coord);\r\n    }";
e.c("TestSquare",{init:function(){this.has("WebGL")&&this._establishShader("TestSquare",this._fragmentShader)},_fragmentShader:n}),e.c("TestSquareWhite",{init:function(){this.has("WebGL")&&this._establishShader("TestSquareWhite",this._fragmentShader)},_fragmentShader:r}),e.c("TestColor",{init:function(){if(this.has("WebGL")){{this.webgl.context}this._establishShader("TestColor",this._fragmentShader,this._vertexShader),"undefined"==typeof this._shaderProgram.posLocation&&this._specializeProgram(),this._glNum=this._shaderProgram._elementCount++}this._red=this._blue=this._green=1,this.bind("Draw",this._drawColor)},_specializeProgram:function(){var t=this.webgl.context;console.log("setting positions");var e=this._shaderProgram;e._bufferArray=new Float32Array(4e3),e._kingBuffer=t.createBuffer(),e.index=new Uint16Array(600),e._indexBuffer=t.createBuffer(),e.posLocation=t.getAttribLocation(e,"aPosition"),t.enableVertexAttribArray(e.posLocation),e.extrasLocation=t.getAttribLocation(e,"aExtras"),t.enableVertexAttribArray(e.extrasLocation),e.colLocation=t.getAttribLocation(e,"aColor"),t.enableVertexAttribArray(e.colLocation),e._elementCount=0;var i=Float32Array.BYTES_PER_ELEMENT,n=10*i;e.stride=n,e.switchTo=function(){t.useProgram(e),t.bindBuffer(t.ARRAY_BUFFER,e._kingBuffer),t.vertexAttribPointer(e.posLocation,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(e.extrasLocation,4,t.FLOAT,!1,n,2*i),t.vertexAttribPointer(e.colLocation,4,t.FLOAT,!1,n,6*i)},e.renderBatch=function(){t.bindBuffer(t.ARRAY_BUFFER,e._kingBuffer),t.bufferData(t.ARRAY_BUFFER,e._bufferArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.index,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,e.pointer,t.UNSIGNED_SHORT,0)}},_fragmentShader:"precision mediump float;varying lowp vec4 vColor;void main(void) {  gl_FragColor = vColor;}",_vertexShader:s,_drawColor:function(t){var e=(t.gl,t.program);this._writeToArray(e._bufferArray);var i=4*this._glNum,n=e.index,r=e.pointer;n[0+r]=0+i,n[1+r]=1+i,n[2+r]=2+i,n[3+r]=1+i,n[4+r]=2+i,n[5+r]=3+i,e.pointer+=6},_writeToArray:function(t){var e=10,i=4*e*this._glNum;glHelpers.writeVec2(t,i,e,this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),glHelpers.writeVec4(t,i+2,e,this._origin.x+this._x,this._origin.y+this._y,this._z,this._rotation),glHelpers.writeVec4(t,i+6,e,this._red,this._green,this._blue,1)},color:function(t,e,i){return this._red=t,this._green=e,this._blue=i,this}}),e.c("GLSprite",{init:function(){if(this.has("WebGL")){{this.webgl.context}this._establishShader(this.__image,this._fragmentShader,this._vertexShader),"undefined"==typeof this._shaderProgram.posLocation&&this._specializeProgram(),this._glNum=this._shaderProgram._elementCount++}this.bind("Draw",this._drawSprite)},_specializeProgram:function(){var t=this.webgl.context,e=this.webgl;console.log("setting sprite positions");var i=this._shaderProgram;i.__texture=e.makeTexture(this.__image,this.img),e.bindTexture(this._shaderProgram,i.__texture),i._bufferArray=new Float32Array(4e3),i._kingBuffer=t.createBuffer(),i.index=new Uint16Array(600),i._indexBuffer=t.createBuffer(),i.posLocation=t.getAttribLocation(i,"aPosition"),t.enableVertexAttribArray(i.posLocation),i.extrasLocation=t.getAttribLocation(i,"aExtras"),t.enableVertexAttribArray(i.extrasLocation),i.textureLocation=t.getAttribLocation(i,"aTextureCoord"),t.enableVertexAttribArray(i.textureLocation),i._elementCount=0;var n=Float32Array.BYTES_PER_ELEMENT,r=8*n;i.stride=r,i.switchTo=function(){t.useProgram(i),t.bindBuffer(t.ARRAY_BUFFER,i._kingBuffer),t.vertexAttribPointer(i.posLocation,2,t.FLOAT,!1,r,0),t.vertexAttribPointer(i.extrasLocation,4,t.FLOAT,!1,r,2*n),t.vertexAttribPointer(i.colLocation,4,t.FLOAT,!1,r,6*n)},i.renderBatch=function(){t.bindBuffer(t.ARRAY_BUFFER,i._kingBuffer),t.bufferData(t.ARRAY_BUFFER,i._bufferArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i.index,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,i.pointer,t.UNSIGNED_SHORT,0)}},_fragmentShader:a,_vertexShader:o,_drawSprite:function(t){var e=(t.gl,t.program);this._writeToArray(e._bufferArray,t.co);var i=4*this._glNum,n=e.index,r=e.pointer;n[0+r]=0+i,n[1+r]=1+i,n[2+r]=2+i,n[3+r]=1+i,n[4+r]=2+i,n[5+r]=3+i,e.pointer+=6},_writeToArray:function(t,e){var i=8,n=4*i*this._glNum;glHelpers.writeVec2(t,n,i,this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),glHelpers.writeVec4(t,n+2,i,this._origin.x+this._x,this._origin.y+this._y,this._z,this._rotation),glHelpers.writeVec2(t,n+6,i,e.x,e.y,e.x,e.y+e.h,e.x+e.w,e.y,e.x+e.w,e.y+e.h)}}),e.c("WebGL",{init:function(){e.webgl.context||e.webgl.init();{var t=this.webgl=e.webgl;t.context}t.entities++,this._changed=!0,t.add(this),this.bind("Change",function(){this._changed===!1&&(this._changed=!0,t.add(this))}),this.bind("Remove",function(){t.entities--,this._changed=!0,t.add(this)})},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,n,r){if(this.ready){4===arguments.length&&(r=n,n=i,i=e,e=t,t=this.webgl.context);var s=this.drawVars.pos;s._x=this._x+(e||0),s._y=this._y+(i||0),s._w=n||this._w,s._h=r||this._h;var o=this.__coord||[0,0,0,0],a=this.drawVars.co;a.x=o[0]+(e||0),a.y=o[1]+(i||0),a.w=n||o[2],a.h=r||o[3],this._flipX||this._flipY,this._alpha<1;var h=this.webgl.context;return this.drawVars.gl=h,this.drawVars.program=this._shaderProgram,this.trigger("Draw",this.drawVars),this}},_establishShader:function(t,e,i){console.log("Establishing shader");var n=this.webgl;"undefined"==typeof n.programs[t]&&(n.programs[t]=glHelpers.makeProgram(gl,e,i)),this._shaderProgram=n.programs[t],this.ready=!0}}),e.extend({webgl:{context:null,entities:0,changed_objects:[],add:function(t){this.changed_objects.push(t)},programs:{},compileShader:function(t,e){var i=this.context,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw i.getShaderInfoLog(n);return n},makeProgram:function(t,e){console.log("Making program"),console.log(t);var i=this.context,n=this.compileShader(t,i.FRAGMENT_SHADER),r=e?this.compileShader(e,i.VERTEX_SHADER):this.defaultVertexShader,s=i.createProgram();if(i.attachShader(s,r),i.attachShader(s,n),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS))throw"Could not initialise shaders";return s.viewport=i.getUniformLocation(s,"uViewport"),s},textures:{},textureCount:0,makeTexture:function(t,e){var i=this;if("undefined"!=typeof i.textures[t])return i.textures[t];var n=i.context,r=n.createTexture();return n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.bindTexture(n.TEXTURE_2D,null),n.activeTexture(n["TEXTURE"+i.textureCount]),n.bindTexture(n.TEXTURE_2D,r),i.textures[t]={t:r,sampler:i.textureCount,key:"TEXTURE"+i.textureCount,width:e.width,height:e.height,url:t},i.textureCount++,n.activeTexture(n["TEXTURE"+i.textureCount]),i.textures[t]},bindTexture:function(t,e){if("undefined"==typeof t.texture_obj){this.context;gl.useProgram(t),gl.uniform1i(gl.getUniformLocation(t,"uSampler"),e.sampler),gl.uniform2f(gl.getUniformLocation(t,"uTextureDimensions"),e.width,e.height),t.texture_obj=e}},init:function(){if(!e.support.webgl)return e.trigger("NoWebGL"),void e.stop();var t;t=i.createElement("canvas"),t.width=e.viewport.width,t.height=e.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",e.stage.elem.appendChild(t);var n;try{n=t.getContext("webgl")||t.getContext("experimental-webgl"),n.viewportWidth=t.width,n.viewportHeight=t.height}catch(r){}if(!n)return void e.trigger("NoWebGL");this.context=n,this._canvas=t,n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST);var s=this;e.uniqueBind("RenderScene",s.render),e.uniqueBind("ViewportResize",s._resize),e.uniqueBind("InvalidateViewport",function(){s.dirtyViewport=!0}),this.dirtyViewport=!0,console.log("webgl inited")},_resize:function(){var t=e.webgl._canvas;t.width=e.viewport.width,t.height=e.viewport.height,gl.viewportWidth=t.widtxh,gl.viewportHeight=t.height},setViewportUniforms:function(t){gl=this.webgl.context,gl.useProgram(t);var i=e.viewport;gl.uniform4f(t.viewport,i._x,i._y,i._width,i._height)},render:function(t){t=t||e.viewport.rect();var i,n=e.map.search(t),r=0,s=n.length,o=e.webgl,a=o.context;a.viewport(0,0,a.viewportWidth,a.viewportHeight),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var h,l=o.programs;if(o.dirtyViewport){for(var u in l)o.setViewportUniforms(l[u]);o.dirtyViewport=!1}var c=0;for(h=null;s>r;r++)i=n[r],i._visible&&i.__c.WebGL&&(h!==i._shaderProgram&&(null!==h&&(h.renderBatch(),c++),h=i._shaderProgram,h.pointer=0,h.switchTo()),i.draw(),i._changed=!1);null!==h&&(h.renderBatch(),c++),console.log("Batches: "+c)}}})},{"./core.js":9}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),Game={gridSize:32,height:innerHeight-32,width:4/3*innerHeight,scale:innerHeight/768,score:0,sprites:"data:image/png;base64,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",maps:{},start:function(){Crafty.init(Game.width,Game.height),Crafty.canvas.init(),Crafty.canvas.context.webkitImageSmoothingEnabled=!1,Crafty.canvas.context.mozImageSmoothingEnabled=!1,Crafty.canvas.context.imageSmoothingEnabled=!1,Crafty.load([Game.sprites],function(){switch(Game.initSprites(),window.location.hash){case"#edit":Crafty.scene("Edit");
break;default:Crafty.scene("Play")}})},initScore:function(){Game.score=0,Game.scoreText=Crafty.e("2D, Canvas, Text").text("Score: 0").textColor("#ffffff").textFont({size:"20px"}).attr({x:10,y:10,w:100,h:30})},addPoints:function(t){Game.score+=t,Game.scoreText.text("Score: "+Game.score)},initSprites:function(){Crafty.sprite(32,Game.sprites,{GfxShuriken:[27,39],GfxPlayer:[26,1],GfxRedBlock:[0,5],GfxRedPlatform:[0,4],GfxBlueBlock:[1,5],GfxBluePlatform:[1,4],GfxGreyBlock:[2,5],GfxGreyPlatform:[2,4],GfxYellowBlock:[3,5],GfxYellowPlatform:[3,4],GfxGreenBlock:[4,5],GfxGreenPlatform:[4,4]})}},window.addEventListener("load",Game.start),Game.maps.jumptest=[[16,22,"GfxRedBlock"],[15,22,"GfxRedBlock"],[14,22,"GfxRedBlock"],[13,22,"GfxRedBlock"],[12,22,"GfxRedBlock"],[11,22,"GfxRedBlock"],[10,22,"GfxRedBlock"],[9,22,"GfxRedBlock"],[8,22,"GfxRedBlock"],[7,22,"GfxRedBlock"],[6,22,"GfxRedBlock"],[5,22,"GfxRedBlock"],[17,22,"GfxRedBlock"],[18,22,"GfxRedBlock"],[19,22,"GfxRedBlock"],[20,22,"GfxRedBlock"],[20,21,"GfxRedPlatform"],[19,21,"GfxRedPlatform"],[18,21,"GfxRedPlatform"],[17,21,"GfxRedPlatform"],[16,21,"GfxRedPlatform"],[15,21,"GfxRedPlatform"],[14,21,"GfxRedPlatform"],[13,21,"GfxRedPlatform"],[12,21,"GfxRedPlatform"],[11,21,"GfxRedPlatform"],[10,21,"GfxRedPlatform"],[5,21,"GfxRedBlock"],[5,20,"GfxYellowBlock"],[5,19,"GfxGreenBlock"],[5,18,"GfxBlueBlock"],[5,17,"GfxGreyBlock"],[6,21,"GfxRedBlock"],[6,17,"GfxGreyPlatform"],[6,18,"GfxBlueBlock"],[7,18,"GfxBluePlatform"],[6,19,"GfxGreenBlock"],[7,19,"GfxGreenBlock"],[8,19,"GfxGreenPlatform"],[6,20,"GfxYellowBlock"],[7,20,"GfxYellowBlock"],[8,20,"GfxYellowBlock"],[9,20,"GfxYellowPlatform"],[9,21,"GfxRedBlock"],[8,21,"GfxRedBlock"],[7,21,"GfxRedBlock"],[5,16,"GfxRedBlock"],[5,15,"GfxRedBlock"],[5,14,"GfxRedBlock"],[5,13,"GfxRedBlock"],[5,12,"GfxRedBlock"],[21,22,"GfxRedBlock"],[21,21,"GfxRedBlock"],[21,20,"GfxYellowBlock"],[21,19,"GfxGreenBlock"],[21,18,"GfxBlueBlock"],[21,17,"GfxGreyBlock"],[20,18,"GfxBluePlatform"],[19,18,"GfxBluePlatform"],[18,18,"GfxBluePlatform"],[21,16,"GfxYellowBlock"],[21,15,"GfxGreenBlock"],[21,14,"GfxBlueBlock"],[21,13,"GfxGreyBlock"],[20,15,"GfxGreenPlatform"],[19,15,"GfxGreenPlatform"],[17,18,"GfxBluePlatform"],[21,12,"GfxRedBlock"],[21,11,"GfxRedBlock"],[21,10,"GfxRedBlock"],[20,10,"GfxRedBlock"],[19,10,"GfxRedBlock"],[18,10,"GfxRedBlock"],[17,10,"GfxRedBlock"],[16,10,"GfxRedBlock"],[15,10,"GfxRedBlock"],[14,10,"GfxRedBlock"],[13,10,"GfxRedBlock"],[12,10,"GfxRedBlock"],[11,10,"GfxRedBlock"],[10,10,"GfxRedBlock"],[9,10,"GfxRedBlock"],[8,10,"GfxRedBlock"],[5,10,"GfxRedBlock"],[5,11,"GfxRedBlock"],[6,10,"GfxRedBlock"],[7,10,"GfxRedBlock"]],Game.maps.test1=[[0,22,"GfxGreyBlock"],[1,22,"GfxGreyBlock"],[2,22,"GfxGreyBlock"],[3,22,"GfxGreyBlock"],[7,22,"GfxGreyBlock"],[8,22,"GfxGreyBlock"],[9,22,"GfxGreyBlock"],[10,22,"GfxGreyBlock"],[14,22,"GfxGreyBlock"],[15,22,"GfxGreyBlock"],[16,22,"GfxGreyBlock"],[17,22,"GfxGreyBlock"],[21,22,"GfxGreyBlock"],[22,22,"GfxGreyBlock"],[23,22,"GfxGreyBlock"],[24,22,"GfxGreyBlock"],[28,22,"GfxGreyBlock"],[29,22,"GfxGreyBlock"],[30,22,"GfxGreyBlock"],[31,22,"GfxGreyBlock"],[0,21,"GfxGreyBlock"],[0,20,"GfxGreyBlock"],[0,19,"GfxGreyBlock"],[0,18,"GfxGreyBlock"],[1,21,"GfxGreyBlock"],[1,20,"GfxGreyBlock"],[1,19,"GfxGreyBlock"],[1,18,"GfxGreyBlock"],[30,21,"GfxGreyBlock"],[31,21,"GfxGreyBlock"],[31,20,"GfxGreyBlock"],[30,20,"GfxGreyBlock"],[30,19,"GfxGreyBlock"],[30,18,"GfxGreyBlock"],[31,18,"GfxGreyBlock"],[31,19,"GfxGreyBlock"],[29,21,"GfxGreyPlatform"],[28,21,"GfxGreyPlatform"],[24,21,"GfxGreyPlatform"],[23,21,"GfxGreyPlatform"],[22,21,"GfxGreyPlatform"],[21,21,"GfxGreyPlatform"],[17,21,"GfxGreyPlatform"],[16,21,"GfxGreyPlatform"],[15,21,"GfxGreyPlatform"],[14,21,"GfxGreyPlatform"],[10,21,"GfxGreyPlatform"],[9,21,"GfxGreyPlatform"],[8,21,"GfxGreyPlatform"],[7,21,"GfxGreyPlatform"],[3,21,"GfxGreyPlatform"],[2,21,"GfxGreyPlatform"],[4,18,"GfxGreyPlatform"],[5,18,"GfxGreyPlatform"],[6,18,"GfxGreyPlatform"],[11,18,"GfxGreyPlatform"],[12,18,"GfxGreyPlatform"],[13,18,"GfxGreyPlatform"],[18,18,"GfxGreyPlatform"],[19,18,"GfxGreyPlatform"],[20,18,"GfxGreyPlatform"],[25,18,"GfxGreyPlatform"],[26,18,"GfxGreyPlatform"],[27,18,"GfxGreyPlatform"],[1,17,"GfxBlueBlock"],[0,17,"GfxBlueBlock"],[1,16,"GfxBlueBlock"],[0,16,"GfxBlueBlock"],[1,15,"GfxBlueBlock"],[0,15,"GfxBlueBlock"],[0,14,"GfxBlueBlock"],[0,13,"GfxBlueBlock"],[31,17,"GfxBlueBlock"],[30,17,"GfxBlueBlock"],[31,16,"GfxBlueBlock"],[30,16,"GfxBlueBlock"],[31,15,"GfxBlueBlock"],[30,15,"GfxBlueBlock"],[31,14,"GfxBlueBlock"],[31,13,"GfxBlueBlock"],[2,15,"GfxBluePlatform"],[3,15,"GfxBluePlatform"],[7,15,"GfxBluePlatform"],[8,15,"GfxBluePlatform"],[10,15,"GfxBluePlatform"],[9,15,"GfxBluePlatform"],[14,15,"GfxBluePlatform"],[15,15,"GfxBluePlatform"],[16,15,"GfxBluePlatform"],[17,15,"GfxBluePlatform"],[21,15,"GfxBluePlatform"],[22,15,"GfxBluePlatform"],[23,15,"GfxBluePlatform"],[24,15,"GfxBluePlatform"],[28,15,"GfxBluePlatform"],[29,15,"GfxBluePlatform"],[0,12,"GfxGreenBlock"],[0,11,"GfxGreenBlock"],[0,10,"GfxGreenBlock"],[0,9,"GfxGreenBlock"],[0,8,"GfxGreenBlock"],[31,12,"GfxGreenBlock"],[31,11,"GfxGreenBlock"],[31,10,"GfxGreenBlock"],[31,9,"GfxGreenBlock"],[31,8,"GfxGreenBlock"],[1,12,"GfxGreenPlatform"],[30,12,"GfxGreenPlatform"],[27,9,"GfxGreenPlatform"],[26,9,"GfxGreenPlatform"],[25,9,"GfxGreenPlatform"],[24,9,"GfxGreenPlatform"],[23,9,"GfxGreenPlatform"],[22,9,"GfxGreenPlatform"],[21,9,"GfxGreenPlatform"],[10,9,"GfxGreenPlatform"],[9,9,"GfxGreenPlatform"],[8,9,"GfxGreenPlatform"],[7,9,"GfxGreenPlatform"],[6,9,"GfxGreenPlatform"],[5,9,"GfxGreenPlatform"],[4,9,"GfxGreenPlatform"],[11,9,"GfxGreenBlock"],[12,9,"GfxGreenBlock"],[20,9,"GfxGreenBlock"],[19,9,"GfxGreenBlock"],[0,7,"GfxYellowBlock"],[0,6,"GfxYellowBlock"],[0,5,"GfxYellowBlock"],[0,4,"GfxYellowBlock"],[0,3,"GfxYellowBlock"],[31,7,"GfxYellowBlock"],[31,6,"GfxYellowBlock"],[31,5,"GfxYellowBlock"],[31,4,"GfxYellowBlock"],[31,3,"GfxYellowBlock"],[31,2,"GfxRedBlock"],[31,0,"GfxRedBlock"],[0,2,"GfxRedBlock"],[0,0,"GfxRedBlock"],[1,0,"GfxRedBlock"],[2,0,"GfxRedBlock"],[3,0,"GfxRedBlock"],[3,1,"GfxRedBlock"],[3,2,"GfxRedBlock"],[30,0,"GfxRedBlock"],[29,0,"GfxRedBlock"],[28,0,"GfxRedBlock"],[28,1,"GfxRedBlock"],[28,2,"GfxRedBlock"],[7,1,"GfxRedBlock"],[7,0,"GfxRedBlock"],[8,2,"GfxRedBlock"],[9,2,"GfxRedBlock"],[10,0,"GfxRedBlock"],[10,1,"GfxRedBlock"],[8,0,"GfxRedBlock"],[9,0,"GfxRedBlock"],[15,2,"GfxRedBlock"],[16,2,"GfxRedBlock"],[17,1,"GfxRedBlock"],[14,1,"GfxRedBlock"],[14,0,"GfxRedBlock"],[15,0,"GfxRedBlock"],[16,0,"GfxRedBlock"],[17,0,"GfxRedBlock"],[21,1,"GfxRedBlock"],[21,0,"GfxRedBlock"],[22,0,"GfxRedBlock"],[23,0,"GfxRedBlock"],[24,0,"GfxRedBlock"],[24,1,"GfxRedBlock"],[23,2,"GfxRedBlock"],[22,2,"GfxRedBlock"],[1,2,"GfxRedBlock"],[2,2,"GfxRedBlock"],[7,2,"GfxRedBlock"],[10,2,"GfxRedBlock"],[14,2,"GfxRedBlock"],[17,2,"GfxRedBlock"],[24,2,"GfxRedBlock"],[21,2,"GfxRedBlock"],[30,2,"GfxRedBlock"],[29,2,"GfxRedBlock"],[31,1,"GfxRedBlock"],[0,1,"GfxRedBlock"],[6,6,"GfxYellowPlatform"],[7,6,"GfxYellowPlatform"],[8,6,"GfxYellowPlatform"],[9,6,"GfxYellowPlatform"],[10,6,"GfxYellowPlatform"],[11,6,"GfxYellowPlatform"],[20,6,"GfxYellowPlatform"],[21,6,"GfxYellowPlatform"],[22,6,"GfxYellowPlatform"],[23,6,"GfxYellowPlatform"],[24,6,"GfxYellowPlatform"],[25,6,"GfxYellowPlatform"],[15,5,"GfxYellowPlatform"],[16,5,"GfxYellowPlatform"],[15,12,"GfxGreenPlatform"],[16,12,"GfxGreenPlatform"]],Game.maps.test2=[["default",0,736,!1],["default",32,736,!1],["default",192,736,!1],["default",224,736,!1],["default",256,736,!1],["default",416,736,!1],["default",448,736,!1],["default",576,736,!1],["default",768,736,!1],["default",800,736,!1],["default",960,736,!1],["default",992,736,!1],["default",736,736,!1],["default",544,736,!1],["default",480,736,!1],["default",512,736,!1],["default",224,704,!0],["default",256,704,!0],["default",192,704,!0],["default",736,704,!0],["default",768,704,!0],["default",800,704,!0],["default",480,704,!0],["default",512,704,!0],["default",448,704,!0],["default",544,704,!0],["default",416,704,!0],["default",608,704,!0],["default",576,704,!0],["default",384,704,!0],["default",64,704,!0],["default",32,704,!0],["default",0,704,!1],["default",928,704,!0],["default",960,704,!0],["default",992,704,!1],["default",0,672,!1],["default",0,640,!1],["default",0,608,!1],["default",0,576,!1],["default",0,544,!1],["default",0,512,!1],["default",0,480,!1],["default",0,448,!1],["default",992,672,!1],["default",992,640,!1],["default",992,608,!1],["default",992,576,!1],["default",992,544,!1],["default",992,512,!1],["default",992,480,!1],["default",992,448,!1],["default",992,416,!1],["default",992,352,!1],["default",992,384,!1],["default",992,320,!1],["default",992,288,!1],["default",992,256,!1],["default",992,224,!1],["default",992,192,!1],["default",0,416,!1],["default",0,384,!1],["default",0,352,!1],["default",0,320,!1],["default",0,288,!1],["default",0,256,!1],["default",0,224,!1],["default",0,192,!1],["default",0,160,!1],["default",0,128,!1],["default",0,96,!1],["default",0,64,!1],["default",0,32,!1],["default",0,0,!0],["default",992,128,!1],["default",992,160,!1],["default",992,96,!1],["default",992,64,!1],["default",992,32,!1],["default",992,0,!0],["default",32,544,!1],["default",64,544,!1],["default",96,544,!1],["default",128,512,!0],["default",32,512,!0],["default",64,512,!0],["default",96,512,!0],["default",960,544,!1],["default",928,544,!1],["default",896,544,!1],["default",960,512,!0],["default",928,512,!0],["default",896,512,!0],["default",864,512,!0],["default",320,512,!0],["default",352,512,!0],["default",352,544,!1],["default",640,544,!1],["default",640,512,!0],["default",672,512,!0],["default",608,544,!1],["default",576,512,!0],["default",608,512,!0],["default",384,512,!0],["default",416,512,!0],["default",384,544,!1],["default",448,544,!1],["default",480,544,!1],["default",512,544,!1],["default",576,544,!1],["default",544,544,!1],["default",416,544,!1],["default",448,512,!1],["default",480,512,!1],["default",512,512,!1],["default",544,512,!1],["default",480,480,!1],["default",480,448,!1],["default",480,416,!1],["default",512,480,!1],["default",512,416,!1],["default",512,448,!1],["default",448,480,!1],["default",448,448,!1],["default",448,416,!1],["default",448,384,!1],["default",480,384,!1],["default",512,384,!1],["default",544,384,!1],["default",544,480,!1],["default",544,448,!1],["default",544,416,!1],["default",576,384,!1],["default",416,384,!1],["default",480,352,!1],["default",544,352,!1],["default",512,352,!1],["default",448,352,!1],["default",448,320,!1],["default",448,288,!1],["default",448,256,!0],["default",416,352,!0],["default",384,352,!0],["default",576,352,!0],["default",608,352,!0],["default",544,320,!1],["default",512,320,!1],["default",480,320,!1],["default",480,288,!1],["default",512,288,!1],["default",544,288,!1],["default",544,256,!0],["default",512,256,!1],["default",480,256,!1],["default",32,0,!0],["default",192,0,!0],["default",224,0,!0],["default",256,0,!0],["default",416,0,!0],["default",448,0,!0],["default",480,0,!0],["default",512,0,!0],["default",544,0,!0],["default",576,0,!0],["default",736,0,!0],["default",800,0,!0],["default",768,0,!0],["default",32,32,!1],["default",32,64,!1],["default",32,96,!1],["default",32,128,!1],["default",32,160,!1],["default",32,192,!1],["default",32,224,!1],["default",32,256,!1],["default",64,256,!0],["default",96,256,!0],["default",128,256,!0],["default",32,288,!1],["default",64,288,!1],["default",960,0,!0],["default",960,32,!1],["default",960,64,!1],["default",960,96,!1],["default",960,128,!1],["default",960,160,!1],["default",960,192,!1],["default",960,224,!1],["default",960,256,!1],["default",928,256,!0],["default",896,256,!0],["default",864,256,!0],["default",960,288,!1],["default",928,288,!1],["default",320,160,!1],["default",352,160,!1],["default",320,128,!0],["default",352,128,!0],["default",288,128,!0],["default",384,128,!0],["default",608,128,!0],["default",640,128,!0],["default",672,128,!0],["default",704,128,!0],["default",672,160,!1],["default",640,160,!1],["default",480,32,!1],["default",512,32,!1],["default",224,32,!1],["default",768,32,!1],["default",480,64,!1],["default",512,64,!1],["default",480,224,!1],["default",480,192,!0],["default",512,192,!0],["default",512,224,!1],["default",448,576,!1],["default",544,576,!1],["default",416,576,!1],["default",576,576,!1]],Crafty.c("Block",{_sprite:null,init:function(){this.requires("2D, Position, Canvas"),this.attr({w:Game.gridSize,h:Game.gridSize}),this.bind("NewComponent",function(t){var e=t[0];this._sprite=e,-1!==e.toLowerCase().search("platform")&&this.attach(Crafty.e("2D, Canvas, Platform").attr({h:3,w:this.w,x:this.x,y:this.y}))})},setSprite:function(t){return this.addComponent(t)},getSprite:function(){return this._sprite}}),Crafty.c("BlockCollision",{_stuck:!1,init:function(){this.requires("2D, Collision, Gravity"),this.bind("Moved",function(t){this.hit("Block")&&(this.x=t.x,t.y>this.y&&(this._up=!1)),this._y>Crafty.DOM.translate(0,Game.height).y&&(this.y=0)}),this.gravity("Platform")}}),Crafty.c("DirectedMotion",{_direction:null,init:function(){this.requires("2D"),this._direction={x:0,y:0}},target:function(t){var e,i=this._direction;return i.x=t.x-this.x,i.y=t.y-this.y,e=Math.sqrt(i.x*i.x+i.y*i.y),i.x/=e,i.y/=e,this._direction=i,this},moveInDirection:function(t,e){var i={x:this._x,y:this._y};return e&&this.target(e),this._direction.x>0?this.unflip():this.flip(),this.attr({x:this.x+this._direction.x*t,y:this.y+this._direction.y*t}),this.trigger("Moved",i),this}}),Crafty.c("MouseEvents",{_events:{click:"Click",dblclick:"DblClick",mousedown:"MouseDown",mouseup:"MouseUp",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut"},init:function(){for(var t in this._events)Crafty.addEvent(this,Crafty.stage.elem,t,this.dispatch)},dispatch:function(t){this.trigger(this._events[t.type],t)}}),Crafty.c("Player",{_shurikens:4,_countText:null,init:function(){this.requires("Position, Canvas, Twoway, BlockCollision, ThrowableCollision, MouseEvents, SpriteAnimation, GfxPlayer"),this.configProperties(),this.configInput(),this.configAnimation()},configAnimation:function(){this.reel("standing",1e4,[[26,1]]),this.reel("running",150,[[27,1],[28,1]]),this.reel("attacking",300,[[29,1],[30,1],[26,1]]),this.reel("dead",1e3,[[31,1]]),this.bind("NewDirection",this.runningAnimation),this.bind("Moved",function(t){this._y!==t.y?this.pauseAnimation():this.resumeAnimation()})},runningAnimation:function(t){var e;t.x&&(e="running"),t.x+t.y===0&&(e="standing"),this.animate(e,-1)},kill:function(){this.animate("dead",1)},configProperties:function(){this.attr({w:Game.gridSize,h:Game.gridSize}).gravityConst(.55)},configInput:function(){this.twoway(5,11).bind("NewDirection",function(t){t.x>0?this.unflip():t.x<0&&this.flip()}).bind("MouseDown",function(t){t.button==Crafty.mouseButtons.LEFT&&(this.animate("attacking",1),this.throw(t))})},takeKnife:function(t){t[0].obj.destroy(),this._shurikens++},"throw":function(t){var e;this._shurikens>0&&(e={x:t.clientX,y:t.clientY},Crafty.e("Shuriken").throw({x:this.x,y:this.y},Crafty.DOM.translate(e.x,e.y)),this._shurikens--)}}),Crafty.c("PlayerInput",{_speed:1,_up:!1,_keys:{W:-90,A:180,D:0},init:function(){this.requires("Fourway, Keyboard, Gravity")},twoway:function(t,e){return this.multiway(t,this._keys),t&&(this._speed=t),this._jumpSpeed=arguments.length<2?4*this._speed:e,this.bind("EnterFrame",function(){this.disableControls||this._up&&(this.y-=this._jumpSpeed,this._falling=!0,this.trigger("Moved",{x:this._x,y:this._y+this._jumpSpeed}))}),this}}),Crafty.c("Position",{setPosition:function(t,e){return this.attr({x:Game.gridSize*t,y:Game.gridSize*e})}}),Crafty.c("Shuriken",{init:function(){this.requires("Throwable, GfxShuriken")}}),Crafty.c("Throwable",{speed:16,rotationSpeed:30,stuck:!1,init:function(){this.requires("2D, Canvas, Gravity, Collision, DirectedMotion"),this.origin(16,16).gravity("Ground").gravityConst(.3).attr({w:32,h:32}).onHit("Block",this.stick).onHit("Enemy",function(t){this.stuck||t[0].obj.kill()}).collision(new Crafty.circle(this._origin.x,this._origin.y,10))},stick:function(){this.stuck=!0},"throw":function(t,e){this.attr({x:t.x,y:t.y}),this.target(e),this.bind("EnterFrame",this.fly)},fly:function(){this.stuck?(this.moveInDirection(this.speed-10),this.unbind("EnterFrame",this.fly),this.antigravity(),this.z--):(this.moveInDirection(this.speed),this.attr({rotation:this.rotation+30}),this.y>Game.height&&(this.y=0))}}),Crafty.c("ThrowableCollision",{init:function(){this.requires("Collision"),this.onHit("Throwable",function(t){t[0].obj.stuck&&this.takeKnife(t)})}}),Crafty.c("Bat",{_speed:4,_target:null,init:function(){Crafty.sprite(32,Game.sprites,{GfxEnemyBat:[26,8]}),this.requires("Enemy, Position, Canvas, Gravity, DirectedMotion, Collision, SpriteAnimation, GfxEnemyBat"),this._gameHeight=Crafty.DOM.translate(0,Game.height).y,this._target=Game.player,this.attr({w:Game.gridSize,h:Game.gridSize}).onHit("Player",function(t){this._dead||t[0].obj.kill()}).bind("EnterFrame",this.moving).bind("Moved",function(t){var e=this.hit("Block");e&&this.handleBlockHit(e[0].obj,t)}),this.reel("flying",300,[[26,8],[27,8]]),this.reel("dead",1e4,[[31,8]]),this.animate("flying",-1)},moving:function(){this.moveInDirection(this._speed,this._target)},kill:function(){this._dead=!0,this.unbind("EnterFrame",this.moving),this.animate("dead",-1),this.gravity("Platform"),Game.addPoints(20)},handleBlockHit:function(t,e){var i,n;t._x>e.x&&(i=e.x-200),t._x<e.x&&(i=e.x+200),t._y>e.y&&(n=e.y-200),t._y<e.y&&(n=e.y+200),this._target={x:i,y:n};var r=15,s=function(){0===--r&&(this._target=Game.player,this.unbind("EnterFrame",s))}.bind(this);this.bind("EnterFrame",s)}}),Crafty.c("Demon",{_xDirection:1,_speed:3,init:function(){Crafty.sprite(32,Game.sprites,{GfxEnemyDemon:[27,4]}),this.requires("Enemy, Position, Canvas, Gravity, Collision, SpriteAnimation, GfxEnemyDemon"),this._gameHeight=Crafty.DOM.translate(0,Game.height).y,falling=!1,this.attr({w:Game.gridSize,h:Game.gridSize}).gravity("Platform").onHit("Block",function(t){var e=t[0].obj._x;e>this._x?(this._xDirection=-1,this.flip()):e<this._x&&(this._xDirection=1,this.unflip())}).onHit("Player",function(t){this._dead||t[0].obj.kill()}).bind("EnterFrame",this.moving),this.reel("walking",300,[[27,4],[28,4]]).reel("falling",1e3,[[27,4]]).reel("dead",1e4,[[31,4]]).animate("walking",-1)},moving:function(){this._falling?(this.pauseAnimation(),this.x+=this._xDirection*(this._speed/2)):(this.resumeAnimation(),this.x+=this._xDirection*this._speed),this._y>this._gameHeight&&(this.y=0)},kill:function(){this._dead=!0,this.unbind("EnterFrame",this.moving),this.animate("dead",-1),Game.addPoints(10)},moveLeft:function(){return this._xDirection=-1,this.flip(),this},moveRight:function(){return this._xDirection=1,this}}),Crafty.c("Flame",{_xDirection:1,_speed:2,init:function(){Crafty.sprite(32,Game.sprites,{GfxEnemyFire:[27,13]}),this.requires("Enemy, Position, Canvas, Gravity, Collision, SpriteAnimation, GfxEnemyFire"),this._gameHeight=Crafty.DOM.translate(0,Game.height).y,this.attr({w:Game.gridSize,h:Game.gridSize}).gravity("Platform").onHit("Block",function(t){var e=t[0].obj._x;e>this._x?(this._xDirection=-1,this.flip()):e<this._x&&(this._xDirection=1,this.unflip())}).onHit("Player",function(t){this._dead||t[0].obj.kill()}).bind("EnterFrame",this.moving),this.reel("walking",800,[[27,13],[30,13]]),this.reel("dead",1e4,[[31,13]]),this.animate("walking",-1)},moving:function(){this.x+=this._falling?this._xDirection*(this._speed/2):this._xDirection*this._speed,this._y>this._gameHeight&&(this.y=0)},kill:function(){this._dead=!0,this.unbind("EnterFrame",this.moving),this.animate("dead",-1),Game.addPoints(10)},moveLeft:function(){return this._xDirection=-1,this.flip(),this},moveRight:function(){return this._xDirection=1,this}}),Crafty.c("Ghost",{_speed:1,_target:null,init:function(){Crafty.sprite(32,Game.sprites,{GfxEnemyGhost:[27,7]}),this.requires("Enemy, Position, Canvas, Gravity, DirectedMotion, Collision, SpriteAnimation, GfxEnemyGhost"),this._gameHeight=Crafty.DOM.translate(0,Game.height).y,this._target=Game.player,this.attr({w:Game.gridSize,h:Game.gridSize}).onHit("Player",function(t){this._dead||t[0].obj.kill(),this.unbind("EnterFrame",this.moving)}).bind("EnterFrame",this.moving),this.reel("flying",1e3,[[28,7],[27,7]]),this.reel("dead",1e4,[[31,7]]),this.animate("flying",-1)},moving:function(){this.moveInDirection(this._speed,this._target)},kill:function(){this._dead=!0,this.unbind("EnterFrame",this.moving),this.animate("dead",-1),this.gravity("Platform"),Game.addPoints(20)}}),Crafty.c("Skeleton",{_xDirection:1,_speed:1,init:function(){Crafty.sprite(32,Game.sprites,{GfxEnemyGhost:[27,6]}),this.requires("Enemy, Position, Canvas, Gravity, Collision, SpriteAnimation, GfxEnemyGhost"),this._gameHeight=Crafty.DOM.translate(0,Game.height).y,this.attr({w:Game.gridSize,h:Game.gridSize}).gravity("Platform").onHit("Block",function(t){var e=t[0].obj._x;e>this._x?(this._xDirection=-1,this.flip()):e<this._x&&(this._xDirection=1,this.unflip())}).onHit("Player",function(t){this._dead||t[0].obj.kill()}).bind("EnterFrame",this.moving),this.reel("walking",350,[[27,6],[28,6]]),this.reel("dead",1e4,[[31,6]]),this.animate("walking",-1)},moving:function(){this._falling?(this.pauseAnimation(),this.x+=this._xDirection*(this._speed/2)):(this.resumeAnimation(),this.x+=this._xDirection*this._speed),this._y>this._gameHeight&&(this.y=0)},kill:function(){this._dead=!0,this.unbind("EnterFrame",this.moving),this.animate("dead",-1),Game.addPoints(10)},moveLeft:function(){return this._xDirection=-1,this.flip(),this},moveRight:function(){return this._xDirection=1,this}}),Crafty.scene("Play",function(){Crafty.background("black"),Crafty.viewport.scale(Game.scale);var t,e=Game.maps[window.location.hash.substring(1)]||Game.maps.test1;for(t in e)Crafty.e("Block").setPosition(e[t][0],e[t][1]).setSprite(e[t][2]);Game.player=Crafty.e("Player").setPosition(15,18),Crafty.e("Ghost").setPosition(15,3),Game.initScore()});</script>
</head><body></body></html>